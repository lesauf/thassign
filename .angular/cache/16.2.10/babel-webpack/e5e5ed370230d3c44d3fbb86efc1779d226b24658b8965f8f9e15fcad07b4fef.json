{"ast":null,"code":"import { __assign, __extends } from 'tslib';\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n/**\r\n * @fileoverview Firebase constants.  Some of these (@defines) can be overridden at compile-time.\r\n */\nvar CONSTANTS = {\n  /**\r\n   * @define {boolean} Whether this is the client Node.js SDK.\r\n   */\n  NODE_CLIENT: false,\n  /**\r\n   * @define {boolean} Whether this is the Admin Node.js SDK.\r\n   */\n  NODE_ADMIN: false,\n  /**\r\n   * Firebase SDK Version\r\n   */\n  SDK_VERSION: '${JSCORE_VERSION}'\n};\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n/**\r\n * Throws an error if the provided assertion is falsy\r\n */\nvar assert = function (assertion, message) {\n  if (!assertion) {\n    throw assertionError(message);\n  }\n};\n/**\r\n * Returns an Error object suitable for throwing.\r\n */\nvar assertionError = function (message) {\n  return new Error('Firebase Database (' + CONSTANTS.SDK_VERSION + ') INTERNAL ASSERT FAILED: ' + message);\n};\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\nvar stringToByteArray$1 = function (str) {\n  // TODO(user): Use native implementations if/when available\n  var out = [];\n  var p = 0;\n  for (var i = 0; i < str.length; i++) {\n    var c = str.charCodeAt(i);\n    if (c < 128) {\n      out[p++] = c;\n    } else if (c < 2048) {\n      out[p++] = c >> 6 | 192;\n      out[p++] = c & 63 | 128;\n    } else if ((c & 0xfc00) === 0xd800 && i + 1 < str.length && (str.charCodeAt(i + 1) & 0xfc00) === 0xdc00) {\n      // Surrogate Pair\n      c = 0x10000 + ((c & 0x03ff) << 10) + (str.charCodeAt(++i) & 0x03ff);\n      out[p++] = c >> 18 | 240;\n      out[p++] = c >> 12 & 63 | 128;\n      out[p++] = c >> 6 & 63 | 128;\n      out[p++] = c & 63 | 128;\n    } else {\n      out[p++] = c >> 12 | 224;\n      out[p++] = c >> 6 & 63 | 128;\n      out[p++] = c & 63 | 128;\n    }\n  }\n  return out;\n};\n/**\r\n * Turns an array of numbers into the string given by the concatenation of the\r\n * characters to which the numbers correspond.\r\n * @param bytes Array of numbers representing characters.\r\n * @return Stringification of the array.\r\n */\nvar byteArrayToString = function (bytes) {\n  // TODO(user): Use native implementations if/when available\n  var out = [];\n  var pos = 0,\n    c = 0;\n  while (pos < bytes.length) {\n    var c1 = bytes[pos++];\n    if (c1 < 128) {\n      out[c++] = String.fromCharCode(c1);\n    } else if (c1 > 191 && c1 < 224) {\n      var c2 = bytes[pos++];\n      out[c++] = String.fromCharCode((c1 & 31) << 6 | c2 & 63);\n    } else if (c1 > 239 && c1 < 365) {\n      // Surrogate Pair\n      var c2 = bytes[pos++];\n      var c3 = bytes[pos++];\n      var c4 = bytes[pos++];\n      var u = ((c1 & 7) << 18 | (c2 & 63) << 12 | (c3 & 63) << 6 | c4 & 63) - 0x10000;\n      out[c++] = String.fromCharCode(0xd800 + (u >> 10));\n      out[c++] = String.fromCharCode(0xdc00 + (u & 1023));\n    } else {\n      var c2 = bytes[pos++];\n      var c3 = bytes[pos++];\n      out[c++] = String.fromCharCode((c1 & 15) << 12 | (c2 & 63) << 6 | c3 & 63);\n    }\n  }\n  return out.join('');\n};\n// We define it as an object literal instead of a class because a class compiled down to es5 can't\n// be treeshaked. https://github.com/rollup/rollup/issues/1691\n// Static lookup maps, lazily populated by init_()\nvar base64 = {\n  /**\r\n   * Maps bytes to characters.\r\n   */\n  byteToCharMap_: null,\n  /**\r\n   * Maps characters to bytes.\r\n   */\n  charToByteMap_: null,\n  /**\r\n   * Maps bytes to websafe characters.\r\n   * @private\r\n   */\n  byteToCharMapWebSafe_: null,\n  /**\r\n   * Maps websafe characters to bytes.\r\n   * @private\r\n   */\n  charToByteMapWebSafe_: null,\n  /**\r\n   * Our default alphabet, shared between\r\n   * ENCODED_VALS and ENCODED_VALS_WEBSAFE\r\n   */\n  ENCODED_VALS_BASE: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' + 'abcdefghijklmnopqrstuvwxyz' + '0123456789',\n  /**\r\n   * Our default alphabet. Value 64 (=) is special; it means \"nothing.\"\r\n   */\n  get ENCODED_VALS() {\n    return this.ENCODED_VALS_BASE + '+/=';\n  },\n  /**\r\n   * Our websafe alphabet.\r\n   */\n  get ENCODED_VALS_WEBSAFE() {\n    return this.ENCODED_VALS_BASE + '-_.';\n  },\n  /**\r\n   * Whether this browser supports the atob and btoa functions. This extension\r\n   * started at Mozilla but is now implemented by many browsers. We use the\r\n   * ASSUME_* variables to avoid pulling in the full useragent detection library\r\n   * but still allowing the standard per-browser compilations.\r\n   *\r\n   */\n  HAS_NATIVE_SUPPORT: typeof atob === 'function',\n  /**\r\n   * Base64-encode an array of bytes.\r\n   *\r\n   * @param input An array of bytes (numbers with\r\n   *     value in [0, 255]) to encode.\r\n   * @param webSafe Boolean indicating we should use the\r\n   *     alternative alphabet.\r\n   * @return The base64 encoded string.\r\n   */\n  encodeByteArray: function (input, webSafe) {\n    if (!Array.isArray(input)) {\n      throw Error('encodeByteArray takes an array as a parameter');\n    }\n    this.init_();\n    var byteToCharMap = webSafe ? this.byteToCharMapWebSafe_ : this.byteToCharMap_;\n    var output = [];\n    for (var i = 0; i < input.length; i += 3) {\n      var byte1 = input[i];\n      var haveByte2 = i + 1 < input.length;\n      var byte2 = haveByte2 ? input[i + 1] : 0;\n      var haveByte3 = i + 2 < input.length;\n      var byte3 = haveByte3 ? input[i + 2] : 0;\n      var outByte1 = byte1 >> 2;\n      var outByte2 = (byte1 & 0x03) << 4 | byte2 >> 4;\n      var outByte3 = (byte2 & 0x0f) << 2 | byte3 >> 6;\n      var outByte4 = byte3 & 0x3f;\n      if (!haveByte3) {\n        outByte4 = 64;\n        if (!haveByte2) {\n          outByte3 = 64;\n        }\n      }\n      output.push(byteToCharMap[outByte1], byteToCharMap[outByte2], byteToCharMap[outByte3], byteToCharMap[outByte4]);\n    }\n    return output.join('');\n  },\n  /**\r\n   * Base64-encode a string.\r\n   *\r\n   * @param input A string to encode.\r\n   * @param webSafe If true, we should use the\r\n   *     alternative alphabet.\r\n   * @return The base64 encoded string.\r\n   */\n  encodeString: function (input, webSafe) {\n    // Shortcut for Mozilla browsers that implement\n    // a native base64 encoder in the form of \"btoa/atob\"\n    if (this.HAS_NATIVE_SUPPORT && !webSafe) {\n      return btoa(input);\n    }\n    return this.encodeByteArray(stringToByteArray$1(input), webSafe);\n  },\n  /**\r\n   * Base64-decode a string.\r\n   *\r\n   * @param input to decode.\r\n   * @param webSafe True if we should use the\r\n   *     alternative alphabet.\r\n   * @return string representing the decoded value.\r\n   */\n  decodeString: function (input, webSafe) {\n    // Shortcut for Mozilla browsers that implement\n    // a native base64 encoder in the form of \"btoa/atob\"\n    if (this.HAS_NATIVE_SUPPORT && !webSafe) {\n      return atob(input);\n    }\n    return byteArrayToString(this.decodeStringToByteArray(input, webSafe));\n  },\n  /**\r\n   * Base64-decode a string.\r\n   *\r\n   * In base-64 decoding, groups of four characters are converted into three\r\n   * bytes.  If the encoder did not apply padding, the input length may not\r\n   * be a multiple of 4.\r\n   *\r\n   * In this case, the last group will have fewer than 4 characters, and\r\n   * padding will be inferred.  If the group has one or two characters, it decodes\r\n   * to one byte.  If the group has three characters, it decodes to two bytes.\r\n   *\r\n   * @param input Input to decode.\r\n   * @param webSafe True if we should use the web-safe alphabet.\r\n   * @return bytes representing the decoded value.\r\n   */\n  decodeStringToByteArray: function (input, webSafe) {\n    this.init_();\n    var charToByteMap = webSafe ? this.charToByteMapWebSafe_ : this.charToByteMap_;\n    var output = [];\n    for (var i = 0; i < input.length;) {\n      var byte1 = charToByteMap[input.charAt(i++)];\n      var haveByte2 = i < input.length;\n      var byte2 = haveByte2 ? charToByteMap[input.charAt(i)] : 0;\n      ++i;\n      var haveByte3 = i < input.length;\n      var byte3 = haveByte3 ? charToByteMap[input.charAt(i)] : 64;\n      ++i;\n      var haveByte4 = i < input.length;\n      var byte4 = haveByte4 ? charToByteMap[input.charAt(i)] : 64;\n      ++i;\n      if (byte1 == null || byte2 == null || byte3 == null || byte4 == null) {\n        throw Error();\n      }\n      var outByte1 = byte1 << 2 | byte2 >> 4;\n      output.push(outByte1);\n      if (byte3 !== 64) {\n        var outByte2 = byte2 << 4 & 0xf0 | byte3 >> 2;\n        output.push(outByte2);\n        if (byte4 !== 64) {\n          var outByte3 = byte3 << 6 & 0xc0 | byte4;\n          output.push(outByte3);\n        }\n      }\n    }\n    return output;\n  },\n  /**\r\n   * Lazy static initialization function. Called before\r\n   * accessing any of the static map variables.\r\n   * @private\r\n   */\n  init_: function () {\n    if (!this.byteToCharMap_) {\n      this.byteToCharMap_ = {};\n      this.charToByteMap_ = {};\n      this.byteToCharMapWebSafe_ = {};\n      this.charToByteMapWebSafe_ = {};\n      // We want quick mappings back and forth, so we precompute two maps.\n      for (var i = 0; i < this.ENCODED_VALS.length; i++) {\n        this.byteToCharMap_[i] = this.ENCODED_VALS.charAt(i);\n        this.charToByteMap_[this.byteToCharMap_[i]] = i;\n        this.byteToCharMapWebSafe_[i] = this.ENCODED_VALS_WEBSAFE.charAt(i);\n        this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]] = i;\n        // Be forgiving when decoding and correctly decode both encodings.\n        if (i >= this.ENCODED_VALS_BASE.length) {\n          this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)] = i;\n          this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)] = i;\n        }\n      }\n    }\n  }\n};\n/**\r\n * URL-safe base64 encoding\r\n */\nvar base64Encode = function (str) {\n  var utf8Bytes = stringToByteArray$1(str);\n  return base64.encodeByteArray(utf8Bytes, true);\n};\n/**\r\n * URL-safe base64 encoding (without \".\" padding in the end).\r\n * e.g. Used in JSON Web Token (JWT) parts.\r\n */\nvar base64urlEncodeWithoutPadding = function (str) {\n  // Use base64url encoding and remove padding in the end (dot characters).\n  return base64Encode(str).replace(/\\./g, '');\n};\n/**\r\n * URL-safe base64 decoding\r\n *\r\n * NOTE: DO NOT use the global atob() function - it does NOT support the\r\n * base64Url variant encoding.\r\n *\r\n * @param str To be decoded\r\n * @return Decoded result, if possible\r\n */\nvar base64Decode = function (str) {\n  try {\n    return base64.decodeString(str, true);\n  } catch (e) {\n    console.error('base64Decode failed: ', e);\n  }\n  return null;\n};\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n/**\r\n * Do a deep-copy of basic JavaScript Objects or Arrays.\r\n */\nfunction deepCopy(value) {\n  return deepExtend(undefined, value);\n}\n/**\r\n * Copy properties from source to target (recursively allows extension\r\n * of Objects and Arrays).  Scalar values in the target are over-written.\r\n * If target is undefined, an object of the appropriate type will be created\r\n * (and returned).\r\n *\r\n * We recursively copy all child properties of plain Objects in the source- so\r\n * that namespace- like dictionaries are merged.\r\n *\r\n * Note that the target can be a function, in which case the properties in\r\n * the source Object are copied onto it as static properties of the Function.\r\n *\r\n * Note: we don't merge __proto__ to prevent prototype pollution\r\n */\nfunction deepExtend(target, source) {\n  if (!(source instanceof Object)) {\n    return source;\n  }\n  switch (source.constructor) {\n    case Date:\n      // Treat Dates like scalars; if the target date object had any child\n      // properties - they will be lost!\n      var dateValue = source;\n      return new Date(dateValue.getTime());\n    case Object:\n      if (target === undefined) {\n        target = {};\n      }\n      break;\n    case Array:\n      // Always copy the array source and overwrite the target.\n      target = [];\n      break;\n    default:\n      // Not a plain Object - treat it as a scalar.\n      return source;\n  }\n  for (var prop in source) {\n    // use isValidKey to guard against prototype pollution. See https://snyk.io/vuln/SNYK-JS-LODASH-450202\n    if (!source.hasOwnProperty(prop) || !isValidKey(prop)) {\n      continue;\n    }\n    target[prop] = deepExtend(target[prop], source[prop]);\n  }\n  return target;\n}\nfunction isValidKey(key) {\n  return key !== '__proto__';\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\nvar Deferred = /** @class */function () {\n  function Deferred() {\n    var _this = this;\n    this.reject = function () {};\n    this.resolve = function () {};\n    this.promise = new Promise(function (resolve, reject) {\n      _this.resolve = resolve;\n      _this.reject = reject;\n    });\n  }\n  /**\r\n   * Our API internals are not promiseified and cannot because our callback APIs have subtle expectations around\r\n   * invoking promises inline, which Promises are forbidden to do. This method accepts an optional node-style callback\r\n   * and returns a node-style callback which will resolve or reject the Deferred's promise.\r\n   */\n  Deferred.prototype.wrapCallback = function (callback) {\n    var _this = this;\n    return function (error, value) {\n      if (error) {\n        _this.reject(error);\n      } else {\n        _this.resolve(value);\n      }\n      if (typeof callback === 'function') {\n        // Attaching noop handler just in case developer wasn't expecting\n        // promises\n        _this.promise.catch(function () {});\n        // Some of our callbacks don't expect a value and our own tests\n        // assert that the parameter length is 1\n        if (callback.length === 1) {\n          callback(error);\n        } else {\n          callback(error, value);\n        }\n      }\n    };\n  };\n  return Deferred;\n}();\n\n/**\r\n * @license\r\n * Copyright 2021 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\nfunction createMockUserToken(token, projectId) {\n  if (token.uid) {\n    throw new Error('The \"uid\" field is no longer supported by mockUserToken. Please use \"sub\" instead for Firebase Auth User ID.');\n  }\n  // Unsecured JWTs use \"none\" as the algorithm.\n  var header = {\n    alg: 'none',\n    type: 'JWT'\n  };\n  var project = projectId || 'demo-project';\n  var iat = token.iat || 0;\n  var sub = token.sub || token.user_id;\n  if (!sub) {\n    throw new Error(\"mockUserToken must contain 'sub' or 'user_id' field!\");\n  }\n  var payload = __assign({\n    // Set all required fields to decent defaults\n    iss: \"https://securetoken.google.com/\" + project,\n    aud: project,\n    iat: iat,\n    exp: iat + 3600,\n    auth_time: iat,\n    sub: sub,\n    user_id: sub,\n    firebase: {\n      sign_in_provider: 'custom',\n      identities: {}\n    }\n  }, token);\n  // Unsecured JWTs use the empty string as a signature.\n  var signature = '';\n  return [base64urlEncodeWithoutPadding(JSON.stringify(header)), base64urlEncodeWithoutPadding(JSON.stringify(payload)), signature].join('.');\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n/**\r\n * Returns navigator.userAgent string or '' if it's not defined.\r\n * @return user agent string\r\n */\nfunction getUA() {\n  if (typeof navigator !== 'undefined' && typeof navigator['userAgent'] === 'string') {\n    return navigator['userAgent'];\n  } else {\n    return '';\n  }\n}\n/**\r\n * Detect Cordova / PhoneGap / Ionic frameworks on a mobile device.\r\n *\r\n * Deliberately does not rely on checking `file://` URLs (as this fails PhoneGap\r\n * in the Ripple emulator) nor Cordova `onDeviceReady`, which would normally\r\n * wait for a callback.\r\n */\nfunction isMobileCordova() {\n  return typeof window !== 'undefined' &&\n  // @ts-ignore Setting up an broadly applicable index signature for Window\n  // just to deal with this case would probably be a bad idea.\n  !!(window['cordova'] || window['phonegap'] || window['PhoneGap']) && /ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA());\n}\n/**\r\n * Detect Node.js.\r\n *\r\n * @return true if Node.js environment is detected.\r\n */\n// Node detection logic from: https://github.com/iliakan/detect-node/\nfunction isNode() {\n  try {\n    return Object.prototype.toString.call(global.process) === '[object process]';\n  } catch (e) {\n    return false;\n  }\n}\n/**\r\n * Detect Browser Environment\r\n */\nfunction isBrowser() {\n  return typeof self === 'object' && self.self === self;\n}\nfunction isBrowserExtension() {\n  var runtime = typeof chrome === 'object' ? chrome.runtime : typeof browser === 'object' ? browser.runtime : undefined;\n  return typeof runtime === 'object' && runtime.id !== undefined;\n}\n/**\r\n * Detect React Native.\r\n *\r\n * @return true if ReactNative environment is detected.\r\n */\nfunction isReactNative() {\n  return typeof navigator === 'object' && navigator['product'] === 'ReactNative';\n}\n/** Detects Electron apps. */\nfunction isElectron() {\n  return getUA().indexOf('Electron/') >= 0;\n}\n/** Detects Internet Explorer. */\nfunction isIE() {\n  var ua = getUA();\n  return ua.indexOf('MSIE ') >= 0 || ua.indexOf('Trident/') >= 0;\n}\n/** Detects Universal Windows Platform apps. */\nfunction isUWP() {\n  return getUA().indexOf('MSAppHost/') >= 0;\n}\n/**\r\n * Detect whether the current SDK build is the Node version.\r\n *\r\n * @return true if it's the Node SDK build.\r\n */\nfunction isNodeSdk() {\n  return CONSTANTS.NODE_CLIENT === true || CONSTANTS.NODE_ADMIN === true;\n}\n/** Returns true if we are running in Safari. */\nfunction isSafari() {\n  return !isNode() && navigator.userAgent.includes('Safari') && !navigator.userAgent.includes('Chrome');\n}\n/**\r\n * This method checks if indexedDB is supported by current browser/service worker context\r\n * @return true if indexedDB is supported by current browser/service worker context\r\n */\nfunction isIndexedDBAvailable() {\n  return 'indexedDB' in self && indexedDB != null;\n}\n/**\r\n * This method validates browser/sw context for indexedDB by opening a dummy indexedDB database and reject\r\n * if errors occur during the database open operation.\r\n *\r\n * @throws exception if current browser/sw context can't run idb.open (ex: Safari iframe, Firefox\r\n * private browsing)\r\n */\nfunction validateIndexedDBOpenable() {\n  return new Promise(function (resolve, reject) {\n    try {\n      var preExist_1 = true;\n      var DB_CHECK_NAME_1 = 'validate-browser-context-for-indexeddb-analytics-module';\n      var request_1 = self.indexedDB.open(DB_CHECK_NAME_1);\n      request_1.onsuccess = function () {\n        request_1.result.close();\n        // delete database only when it doesn't pre-exist\n        if (!preExist_1) {\n          self.indexedDB.deleteDatabase(DB_CHECK_NAME_1);\n        }\n        resolve(true);\n      };\n      request_1.onupgradeneeded = function () {\n        preExist_1 = false;\n      };\n      request_1.onerror = function () {\n        var _a;\n        reject(((_a = request_1.error) === null || _a === void 0 ? void 0 : _a.message) || '');\n      };\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n/**\r\n *\r\n * This method checks whether cookie is enabled within current browser\r\n * @return true if cookie is enabled within current browser\r\n */\nfunction areCookiesEnabled() {\n  if (!navigator || !navigator.cookieEnabled) {\n    return false;\n  }\n  return true;\n}\n/**\r\n * Polyfill for `globalThis` object.\r\n * @returns the `globalThis` object for the given environment.\r\n */\nfunction getGlobal() {\n  if (typeof self !== 'undefined') {\n    return self;\n  }\n  if (typeof window !== 'undefined') {\n    return window;\n  }\n  if (typeof global !== 'undefined') {\n    return global;\n  }\n  throw new Error('Unable to locate global object.');\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\nvar ERROR_NAME = 'FirebaseError';\n// Based on code from:\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error#Custom_Error_Types\nvar FirebaseError = /** @class */function (_super) {\n  __extends(FirebaseError, _super);\n  function FirebaseError(code, message, customData) {\n    var _this = _super.call(this, message) || this;\n    _this.code = code;\n    _this.customData = customData;\n    _this.name = ERROR_NAME;\n    // Fix For ES5\n    // https://github.com/Microsoft/TypeScript-wiki/blob/master/Breaking-Changes.md#extending-built-ins-like-error-array-and-map-may-no-longer-work\n    Object.setPrototypeOf(_this, FirebaseError.prototype);\n    // Maintains proper stack trace for where our error was thrown.\n    // Only available on V8.\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(_this, ErrorFactory.prototype.create);\n    }\n    return _this;\n  }\n  return FirebaseError;\n}(Error);\nvar ErrorFactory = /** @class */function () {\n  function ErrorFactory(service, serviceName, errors) {\n    this.service = service;\n    this.serviceName = serviceName;\n    this.errors = errors;\n  }\n  ErrorFactory.prototype.create = function (code) {\n    var data = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n      data[_i - 1] = arguments[_i];\n    }\n    var customData = data[0] || {};\n    var fullCode = this.service + \"/\" + code;\n    var template = this.errors[code];\n    var message = template ? replaceTemplate(template, customData) : 'Error';\n    // Service Name: Error message (service/code).\n    var fullMessage = this.serviceName + \": \" + message + \" (\" + fullCode + \").\";\n    var error = new FirebaseError(fullCode, fullMessage, customData);\n    return error;\n  };\n  return ErrorFactory;\n}();\nfunction replaceTemplate(template, data) {\n  return template.replace(PATTERN, function (_, key) {\n    var value = data[key];\n    return value != null ? String(value) : \"<\" + key + \"?>\";\n  });\n}\nvar PATTERN = /\\{\\$([^}]+)}/g;\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n/**\r\n * Evaluates a JSON string into a javascript object.\r\n *\r\n * @param {string} str A string containing JSON.\r\n * @return {*} The javascript object representing the specified JSON.\r\n */\nfunction jsonEval(str) {\n  return JSON.parse(str);\n}\n/**\r\n * Returns JSON representing a javascript object.\r\n * @param {*} data Javascript object to be stringified.\r\n * @return {string} The JSON contents of the object.\r\n */\nfunction stringify(data) {\n  return JSON.stringify(data);\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n/**\r\n * Decodes a Firebase auth. token into constituent parts.\r\n *\r\n * Notes:\r\n * - May return with invalid / incomplete claims if there's no native base64 decoding support.\r\n * - Doesn't check if the token is actually valid.\r\n */\nvar decode = function (token) {\n  var header = {},\n    claims = {},\n    data = {},\n    signature = '';\n  try {\n    var parts = token.split('.');\n    header = jsonEval(base64Decode(parts[0]) || '');\n    claims = jsonEval(base64Decode(parts[1]) || '');\n    signature = parts[2];\n    data = claims['d'] || {};\n    delete claims['d'];\n  } catch (e) {}\n  return {\n    header: header,\n    claims: claims,\n    data: data,\n    signature: signature\n  };\n};\n/**\r\n * Decodes a Firebase auth. token and checks the validity of its time-based claims. Will return true if the\r\n * token is within the time window authorized by the 'nbf' (not-before) and 'iat' (issued-at) claims.\r\n *\r\n * Notes:\r\n * - May return a false negative if there's no native base64 decoding support.\r\n * - Doesn't check if the token is actually valid.\r\n */\nvar isValidTimestamp = function (token) {\n  var claims = decode(token).claims;\n  var now = Math.floor(new Date().getTime() / 1000);\n  var validSince = 0,\n    validUntil = 0;\n  if (typeof claims === 'object') {\n    if (claims.hasOwnProperty('nbf')) {\n      validSince = claims['nbf'];\n    } else if (claims.hasOwnProperty('iat')) {\n      validSince = claims['iat'];\n    }\n    if (claims.hasOwnProperty('exp')) {\n      validUntil = claims['exp'];\n    } else {\n      // token will expire after 24h by default\n      validUntil = validSince + 86400;\n    }\n  }\n  return !!now && !!validSince && !!validUntil && now >= validSince && now <= validUntil;\n};\n/**\r\n * Decodes a Firebase auth. token and returns its issued at time if valid, null otherwise.\r\n *\r\n * Notes:\r\n * - May return null if there's no native base64 decoding support.\r\n * - Doesn't check if the token is actually valid.\r\n */\nvar issuedAtTime = function (token) {\n  var claims = decode(token).claims;\n  if (typeof claims === 'object' && claims.hasOwnProperty('iat')) {\n    return claims['iat'];\n  }\n  return null;\n};\n/**\r\n * Decodes a Firebase auth. token and checks the validity of its format. Expects a valid issued-at time.\r\n *\r\n * Notes:\r\n * - May return a false negative if there's no native base64 decoding support.\r\n * - Doesn't check if the token is actually valid.\r\n */\nvar isValidFormat = function (token) {\n  var decoded = decode(token),\n    claims = decoded.claims;\n  return !!claims && typeof claims === 'object' && claims.hasOwnProperty('iat');\n};\n/**\r\n * Attempts to peer into an auth token and determine if it's an admin auth token by looking at the claims portion.\r\n *\r\n * Notes:\r\n * - May return a false negative if there's no native base64 decoding support.\r\n * - Doesn't check if the token is actually valid.\r\n */\nvar isAdmin = function (token) {\n  var claims = decode(token).claims;\n  return typeof claims === 'object' && claims['admin'] === true;\n};\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\nfunction contains(obj, key) {\n  return Object.prototype.hasOwnProperty.call(obj, key);\n}\nfunction safeGet(obj, key) {\n  if (Object.prototype.hasOwnProperty.call(obj, key)) {\n    return obj[key];\n  } else {\n    return undefined;\n  }\n}\nfunction isEmpty(obj) {\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      return false;\n    }\n  }\n  return true;\n}\nfunction map(obj, fn, contextObj) {\n  var res = {};\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      res[key] = fn.call(contextObj, obj[key], key, obj);\n    }\n  }\n  return res;\n}\n/**\r\n * Deep equal two objects. Support Arrays and Objects.\r\n */\nfunction deepEqual(a, b) {\n  if (a === b) {\n    return true;\n  }\n  var aKeys = Object.keys(a);\n  var bKeys = Object.keys(b);\n  for (var _i = 0, aKeys_1 = aKeys; _i < aKeys_1.length; _i++) {\n    var k = aKeys_1[_i];\n    if (!bKeys.includes(k)) {\n      return false;\n    }\n    var aProp = a[k];\n    var bProp = b[k];\n    if (isObject(aProp) && isObject(bProp)) {\n      if (!deepEqual(aProp, bProp)) {\n        return false;\n      }\n    } else if (aProp !== bProp) {\n      return false;\n    }\n  }\n  for (var _a = 0, bKeys_1 = bKeys; _a < bKeys_1.length; _a++) {\n    var k = bKeys_1[_a];\n    if (!aKeys.includes(k)) {\n      return false;\n    }\n  }\n  return true;\n}\nfunction isObject(thing) {\n  return thing !== null && typeof thing === 'object';\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n/**\r\n * Returns a querystring-formatted string (e.g. &arg=val&arg2=val2) from a\r\n * params object (e.g. {arg: 'val', arg2: 'val2'})\r\n * Note: You must prepend it with ? when adding it to a URL.\r\n */\nfunction querystring(querystringParams) {\n  var params = [];\n  var _loop_1 = function (key, value) {\n    if (Array.isArray(value)) {\n      value.forEach(function (arrayVal) {\n        params.push(encodeURIComponent(key) + '=' + encodeURIComponent(arrayVal));\n      });\n    } else {\n      params.push(encodeURIComponent(key) + '=' + encodeURIComponent(value));\n    }\n  };\n  for (var _i = 0, _a = Object.entries(querystringParams); _i < _a.length; _i++) {\n    var _b = _a[_i],\n      key = _b[0],\n      value = _b[1];\n    _loop_1(key, value);\n  }\n  return params.length ? '&' + params.join('&') : '';\n}\n/**\r\n * Decodes a querystring (e.g. ?arg=val&arg2=val2) into a params object\r\n * (e.g. {arg: 'val', arg2: 'val2'})\r\n */\nfunction querystringDecode(querystring) {\n  var obj = {};\n  var tokens = querystring.replace(/^\\?/, '').split('&');\n  tokens.forEach(function (token) {\n    if (token) {\n      var _a = token.split('='),\n        key = _a[0],\n        value = _a[1];\n      obj[decodeURIComponent(key)] = decodeURIComponent(value);\n    }\n  });\n  return obj;\n}\n/**\r\n * Extract the query string part of a URL, including the leading question mark (if present).\r\n */\nfunction extractQuerystring(url) {\n  var queryStart = url.indexOf('?');\n  if (!queryStart) {\n    return '';\n  }\n  var fragmentStart = url.indexOf('#', queryStart);\n  return url.substring(queryStart, fragmentStart > 0 ? fragmentStart : undefined);\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n/**\r\n * @fileoverview SHA-1 cryptographic hash.\r\n * Variable names follow the notation in FIPS PUB 180-3:\r\n * http://csrc.nist.gov/publications/fips/fips180-3/fips180-3_final.pdf.\r\n *\r\n * Usage:\r\n *   var sha1 = new sha1();\r\n *   sha1.update(bytes);\r\n *   var hash = sha1.digest();\r\n *\r\n * Performance:\r\n *   Chrome 23:   ~400 Mbit/s\r\n *   Firefox 16:  ~250 Mbit/s\r\n *\r\n */\n/**\r\n * SHA-1 cryptographic hash constructor.\r\n *\r\n * The properties declared here are discussed in the above algorithm document.\r\n * @constructor\r\n * @final\r\n * @struct\r\n */\nvar Sha1 = /** @class */function () {\n  function Sha1() {\n    /**\r\n     * Holds the previous values of accumulated variables a-e in the compress_\r\n     * function.\r\n     * @private\r\n     */\n    this.chain_ = [];\n    /**\r\n     * A buffer holding the partially computed hash result.\r\n     * @private\r\n     */\n    this.buf_ = [];\n    /**\r\n     * An array of 80 bytes, each a part of the message to be hashed.  Referred to\r\n     * as the message schedule in the docs.\r\n     * @private\r\n     */\n    this.W_ = [];\n    /**\r\n     * Contains data needed to pad messages less than 64 bytes.\r\n     * @private\r\n     */\n    this.pad_ = [];\n    /**\r\n     * @private {number}\r\n     */\n    this.inbuf_ = 0;\n    /**\r\n     * @private {number}\r\n     */\n    this.total_ = 0;\n    this.blockSize = 512 / 8;\n    this.pad_[0] = 128;\n    for (var i = 1; i < this.blockSize; ++i) {\n      this.pad_[i] = 0;\n    }\n    this.reset();\n  }\n  Sha1.prototype.reset = function () {\n    this.chain_[0] = 0x67452301;\n    this.chain_[1] = 0xefcdab89;\n    this.chain_[2] = 0x98badcfe;\n    this.chain_[3] = 0x10325476;\n    this.chain_[4] = 0xc3d2e1f0;\n    this.inbuf_ = 0;\n    this.total_ = 0;\n  };\n  /**\r\n   * Internal compress helper function.\r\n   * @param buf Block to compress.\r\n   * @param offset Offset of the block in the buffer.\r\n   * @private\r\n   */\n  Sha1.prototype.compress_ = function (buf, offset) {\n    if (!offset) {\n      offset = 0;\n    }\n    var W = this.W_;\n    // get 16 big endian words\n    if (typeof buf === 'string') {\n      for (var i = 0; i < 16; i++) {\n        // TODO(user): [bug 8140122] Recent versions of Safari for Mac OS and iOS\n        // have a bug that turns the post-increment ++ operator into pre-increment\n        // during JIT compilation.  We have code that depends heavily on SHA-1 for\n        // correctness and which is affected by this bug, so I've removed all uses\n        // of post-increment ++ in which the result value is used.  We can revert\n        // this change once the Safari bug\n        // (https://bugs.webkit.org/show_bug.cgi?id=109036) has been fixed and\n        // most clients have been updated.\n        W[i] = buf.charCodeAt(offset) << 24 | buf.charCodeAt(offset + 1) << 16 | buf.charCodeAt(offset + 2) << 8 | buf.charCodeAt(offset + 3);\n        offset += 4;\n      }\n    } else {\n      for (var i = 0; i < 16; i++) {\n        W[i] = buf[offset] << 24 | buf[offset + 1] << 16 | buf[offset + 2] << 8 | buf[offset + 3];\n        offset += 4;\n      }\n    }\n    // expand to 80 words\n    for (var i = 16; i < 80; i++) {\n      var t = W[i - 3] ^ W[i - 8] ^ W[i - 14] ^ W[i - 16];\n      W[i] = (t << 1 | t >>> 31) & 0xffffffff;\n    }\n    var a = this.chain_[0];\n    var b = this.chain_[1];\n    var c = this.chain_[2];\n    var d = this.chain_[3];\n    var e = this.chain_[4];\n    var f, k;\n    // TODO(user): Try to unroll this loop to speed up the computation.\n    for (var i = 0; i < 80; i++) {\n      if (i < 40) {\n        if (i < 20) {\n          f = d ^ b & (c ^ d);\n          k = 0x5a827999;\n        } else {\n          f = b ^ c ^ d;\n          k = 0x6ed9eba1;\n        }\n      } else {\n        if (i < 60) {\n          f = b & c | d & (b | c);\n          k = 0x8f1bbcdc;\n        } else {\n          f = b ^ c ^ d;\n          k = 0xca62c1d6;\n        }\n      }\n      var t = (a << 5 | a >>> 27) + f + e + k + W[i] & 0xffffffff;\n      e = d;\n      d = c;\n      c = (b << 30 | b >>> 2) & 0xffffffff;\n      b = a;\n      a = t;\n    }\n    this.chain_[0] = this.chain_[0] + a & 0xffffffff;\n    this.chain_[1] = this.chain_[1] + b & 0xffffffff;\n    this.chain_[2] = this.chain_[2] + c & 0xffffffff;\n    this.chain_[3] = this.chain_[3] + d & 0xffffffff;\n    this.chain_[4] = this.chain_[4] + e & 0xffffffff;\n  };\n  Sha1.prototype.update = function (bytes, length) {\n    // TODO(johnlenz): tighten the function signature and remove this check\n    if (bytes == null) {\n      return;\n    }\n    if (length === undefined) {\n      length = bytes.length;\n    }\n    var lengthMinusBlock = length - this.blockSize;\n    var n = 0;\n    // Using local instead of member variables gives ~5% speedup on Firefox 16.\n    var buf = this.buf_;\n    var inbuf = this.inbuf_;\n    // The outer while loop should execute at most twice.\n    while (n < length) {\n      // When we have no data in the block to top up, we can directly process the\n      // input buffer (assuming it contains sufficient data). This gives ~25%\n      // speedup on Chrome 23 and ~15% speedup on Firefox 16, but requires that\n      // the data is provided in large chunks (or in multiples of 64 bytes).\n      if (inbuf === 0) {\n        while (n <= lengthMinusBlock) {\n          this.compress_(bytes, n);\n          n += this.blockSize;\n        }\n      }\n      if (typeof bytes === 'string') {\n        while (n < length) {\n          buf[inbuf] = bytes.charCodeAt(n);\n          ++inbuf;\n          ++n;\n          if (inbuf === this.blockSize) {\n            this.compress_(buf);\n            inbuf = 0;\n            // Jump to the outer loop so we use the full-block optimization.\n            break;\n          }\n        }\n      } else {\n        while (n < length) {\n          buf[inbuf] = bytes[n];\n          ++inbuf;\n          ++n;\n          if (inbuf === this.blockSize) {\n            this.compress_(buf);\n            inbuf = 0;\n            // Jump to the outer loop so we use the full-block optimization.\n            break;\n          }\n        }\n      }\n    }\n    this.inbuf_ = inbuf;\n    this.total_ += length;\n  };\n  /** @override */\n  Sha1.prototype.digest = function () {\n    var digest = [];\n    var totalBits = this.total_ * 8;\n    // Add pad 0x80 0x00*.\n    if (this.inbuf_ < 56) {\n      this.update(this.pad_, 56 - this.inbuf_);\n    } else {\n      this.update(this.pad_, this.blockSize - (this.inbuf_ - 56));\n    }\n    // Add # bits.\n    for (var i = this.blockSize - 1; i >= 56; i--) {\n      this.buf_[i] = totalBits & 255;\n      totalBits /= 256; // Don't use bit-shifting here!\n    }\n\n    this.compress_(this.buf_);\n    var n = 0;\n    for (var i = 0; i < 5; i++) {\n      for (var j = 24; j >= 0; j -= 8) {\n        digest[n] = this.chain_[i] >> j & 255;\n        ++n;\n      }\n    }\n    return digest;\n  };\n  return Sha1;\n}();\n\n/**\r\n * Helper to make a Subscribe function (just like Promise helps make a\r\n * Thenable).\r\n *\r\n * @param executor Function which can make calls to a single Observer\r\n *     as a proxy.\r\n * @param onNoObservers Callback when count of Observers goes to zero.\r\n */\nfunction createSubscribe(executor, onNoObservers) {\n  var proxy = new ObserverProxy(executor, onNoObservers);\n  return proxy.subscribe.bind(proxy);\n}\n/**\r\n * Implement fan-out for any number of Observers attached via a subscribe\r\n * function.\r\n */\nvar ObserverProxy = /** @class */function () {\n  /**\r\n   * @param executor Function which can make calls to a single Observer\r\n   *     as a proxy.\r\n   * @param onNoObservers Callback when count of Observers goes to zero.\r\n   */\n  function ObserverProxy(executor, onNoObservers) {\n    var _this = this;\n    this.observers = [];\n    this.unsubscribes = [];\n    this.observerCount = 0;\n    // Micro-task scheduling by calling task.then().\n    this.task = Promise.resolve();\n    this.finalized = false;\n    this.onNoObservers = onNoObservers;\n    // Call the executor asynchronously so subscribers that are called\n    // synchronously after the creation of the subscribe function\n    // can still receive the very first value generated in the executor.\n    this.task.then(function () {\n      executor(_this);\n    }).catch(function (e) {\n      _this.error(e);\n    });\n  }\n  ObserverProxy.prototype.next = function (value) {\n    this.forEachObserver(function (observer) {\n      observer.next(value);\n    });\n  };\n  ObserverProxy.prototype.error = function (error) {\n    this.forEachObserver(function (observer) {\n      observer.error(error);\n    });\n    this.close(error);\n  };\n  ObserverProxy.prototype.complete = function () {\n    this.forEachObserver(function (observer) {\n      observer.complete();\n    });\n    this.close();\n  };\n  /**\r\n   * Subscribe function that can be used to add an Observer to the fan-out list.\r\n   *\r\n   * - We require that no event is sent to a subscriber sychronously to their\r\n   *   call to subscribe().\r\n   */\n  ObserverProxy.prototype.subscribe = function (nextOrObserver, error, complete) {\n    var _this = this;\n    var observer;\n    if (nextOrObserver === undefined && error === undefined && complete === undefined) {\n      throw new Error('Missing Observer.');\n    }\n    // Assemble an Observer object when passed as callback functions.\n    if (implementsAnyMethods(nextOrObserver, ['next', 'error', 'complete'])) {\n      observer = nextOrObserver;\n    } else {\n      observer = {\n        next: nextOrObserver,\n        error: error,\n        complete: complete\n      };\n    }\n    if (observer.next === undefined) {\n      observer.next = noop;\n    }\n    if (observer.error === undefined) {\n      observer.error = noop;\n    }\n    if (observer.complete === undefined) {\n      observer.complete = noop;\n    }\n    var unsub = this.unsubscribeOne.bind(this, this.observers.length);\n    // Attempt to subscribe to a terminated Observable - we\n    // just respond to the Observer with the final error or complete\n    // event.\n    if (this.finalized) {\n      // eslint-disable-next-line @typescript-eslint/no-floating-promises\n      this.task.then(function () {\n        try {\n          if (_this.finalError) {\n            observer.error(_this.finalError);\n          } else {\n            observer.complete();\n          }\n        } catch (e) {\n          // nothing\n        }\n        return;\n      });\n    }\n    this.observers.push(observer);\n    return unsub;\n  };\n  // Unsubscribe is synchronous - we guarantee that no events are sent to\n  // any unsubscribed Observer.\n  ObserverProxy.prototype.unsubscribeOne = function (i) {\n    if (this.observers === undefined || this.observers[i] === undefined) {\n      return;\n    }\n    delete this.observers[i];\n    this.observerCount -= 1;\n    if (this.observerCount === 0 && this.onNoObservers !== undefined) {\n      this.onNoObservers(this);\n    }\n  };\n  ObserverProxy.prototype.forEachObserver = function (fn) {\n    if (this.finalized) {\n      // Already closed by previous event....just eat the additional values.\n      return;\n    }\n    // Since sendOne calls asynchronously - there is no chance that\n    // this.observers will become undefined.\n    for (var i = 0; i < this.observers.length; i++) {\n      this.sendOne(i, fn);\n    }\n  };\n  // Call the Observer via one of it's callback function. We are careful to\n  // confirm that the observe has not been unsubscribed since this asynchronous\n  // function had been queued.\n  ObserverProxy.prototype.sendOne = function (i, fn) {\n    var _this = this;\n    // Execute the callback asynchronously\n    // eslint-disable-next-line @typescript-eslint/no-floating-promises\n    this.task.then(function () {\n      if (_this.observers !== undefined && _this.observers[i] !== undefined) {\n        try {\n          fn(_this.observers[i]);\n        } catch (e) {\n          // Ignore exceptions raised in Observers or missing methods of an\n          // Observer.\n          // Log error to console. b/31404806\n          if (typeof console !== 'undefined' && console.error) {\n            console.error(e);\n          }\n        }\n      }\n    });\n  };\n  ObserverProxy.prototype.close = function (err) {\n    var _this = this;\n    if (this.finalized) {\n      return;\n    }\n    this.finalized = true;\n    if (err !== undefined) {\n      this.finalError = err;\n    }\n    // Proxy is no longer needed - garbage collect references\n    // eslint-disable-next-line @typescript-eslint/no-floating-promises\n    this.task.then(function () {\n      _this.observers = undefined;\n      _this.onNoObservers = undefined;\n    });\n  };\n  return ObserverProxy;\n}();\n/** Turn synchronous function into one called asynchronously. */\n// eslint-disable-next-line @typescript-eslint/ban-types\nfunction async(fn, onError) {\n  return function () {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n    Promise.resolve(true).then(function () {\n      fn.apply(void 0, args);\n    }).catch(function (error) {\n      if (onError) {\n        onError(error);\n      }\n    });\n  };\n}\n/**\r\n * Return true if the object passed in implements any of the named methods.\r\n */\nfunction implementsAnyMethods(obj, methods) {\n  if (typeof obj !== 'object' || obj === null) {\n    return false;\n  }\n  for (var _i = 0, methods_1 = methods; _i < methods_1.length; _i++) {\n    var method = methods_1[_i];\n    if (method in obj && typeof obj[method] === 'function') {\n      return true;\n    }\n  }\n  return false;\n}\nfunction noop() {\n  // do nothing\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n/**\r\n * Check to make sure the appropriate number of arguments are provided for a public function.\r\n * Throws an error if it fails.\r\n *\r\n * @param fnName The function name\r\n * @param minCount The minimum number of arguments to allow for the function call\r\n * @param maxCount The maximum number of argument to allow for the function call\r\n * @param argCount The actual number of arguments provided.\r\n */\nvar validateArgCount = function (fnName, minCount, maxCount, argCount) {\n  var argError;\n  if (argCount < minCount) {\n    argError = 'at least ' + minCount;\n  } else if (argCount > maxCount) {\n    argError = maxCount === 0 ? 'none' : 'no more than ' + maxCount;\n  }\n  if (argError) {\n    var error = fnName + ' failed: Was called with ' + argCount + (argCount === 1 ? ' argument.' : ' arguments.') + ' Expects ' + argError + '.';\n    throw new Error(error);\n  }\n};\n/**\r\n * Generates a string to prefix an error message about failed argument validation\r\n *\r\n * @param fnName The function name\r\n * @param argName The name of the argument\r\n * @return The prefix to add to the error thrown for validation.\r\n */\nfunction errorPrefix(fnName, argName) {\n  return fnName + \" failed: \" + argName + \" argument \";\n}\n/**\r\n * @param fnName\r\n * @param argumentNumber\r\n * @param namespace\r\n * @param optional\r\n */\nfunction validateNamespace(fnName, namespace, optional) {\n  if (optional && !namespace) {\n    return;\n  }\n  if (typeof namespace !== 'string') {\n    //TODO: I should do more validation here. We only allow certain chars in namespaces.\n    throw new Error(errorPrefix(fnName, 'namespace') + 'must be a valid firebase namespace.');\n  }\n}\nfunction validateCallback(fnName, argumentName,\n// eslint-disable-next-line @typescript-eslint/ban-types\ncallback, optional) {\n  if (optional && !callback) {\n    return;\n  }\n  if (typeof callback !== 'function') {\n    throw new Error(errorPrefix(fnName, argumentName) + 'must be a valid function.');\n  }\n}\nfunction validateContextObject(fnName, argumentName, context, optional) {\n  if (optional && !context) {\n    return;\n  }\n  if (typeof context !== 'object' || context === null) {\n    throw new Error(errorPrefix(fnName, argumentName) + 'must be a valid context object.');\n  }\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n// Code originally came from goog.crypt.stringToUtf8ByteArray, but for some reason they\n// automatically replaced '\\r\\n' with '\\n', and they didn't handle surrogate pairs,\n// so it's been modified.\n// Note that not all Unicode characters appear as single characters in JavaScript strings.\n// fromCharCode returns the UTF-16 encoding of a character - so some Unicode characters\n// use 2 characters in Javascript.  All 4-byte UTF-8 characters begin with a first\n// character in the range 0xD800 - 0xDBFF (the first character of a so-called surrogate\n// pair).\n// See http://www.ecma-international.org/ecma-262/5.1/#sec-15.1.3\n/**\r\n * @param {string} str\r\n * @return {Array}\r\n */\nvar stringToByteArray = function (str) {\n  var out = [];\n  var p = 0;\n  for (var i = 0; i < str.length; i++) {\n    var c = str.charCodeAt(i);\n    // Is this the lead surrogate in a surrogate pair?\n    if (c >= 0xd800 && c <= 0xdbff) {\n      var high = c - 0xd800; // the high 10 bits.\n      i++;\n      assert(i < str.length, 'Surrogate pair missing trail surrogate.');\n      var low = str.charCodeAt(i) - 0xdc00; // the low 10 bits.\n      c = 0x10000 + (high << 10) + low;\n    }\n    if (c < 128) {\n      out[p++] = c;\n    } else if (c < 2048) {\n      out[p++] = c >> 6 | 192;\n      out[p++] = c & 63 | 128;\n    } else if (c < 65536) {\n      out[p++] = c >> 12 | 224;\n      out[p++] = c >> 6 & 63 | 128;\n      out[p++] = c & 63 | 128;\n    } else {\n      out[p++] = c >> 18 | 240;\n      out[p++] = c >> 12 & 63 | 128;\n      out[p++] = c >> 6 & 63 | 128;\n      out[p++] = c & 63 | 128;\n    }\n  }\n  return out;\n};\n/**\r\n * Calculate length without actually converting; useful for doing cheaper validation.\r\n * @param {string} str\r\n * @return {number}\r\n */\nvar stringLength = function (str) {\n  var p = 0;\n  for (var i = 0; i < str.length; i++) {\n    var c = str.charCodeAt(i);\n    if (c < 128) {\n      p++;\n    } else if (c < 2048) {\n      p += 2;\n    } else if (c >= 0xd800 && c <= 0xdbff) {\n      // Lead surrogate of a surrogate pair.  The pair together will take 4 bytes to represent.\n      p += 4;\n      i++; // skip trail surrogate.\n    } else {\n      p += 3;\n    }\n  }\n  return p;\n};\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n/**\r\n * The amount of milliseconds to exponentially increase.\r\n */\nvar DEFAULT_INTERVAL_MILLIS = 1000;\n/**\r\n * The factor to backoff by.\r\n * Should be a number greater than 1.\r\n */\nvar DEFAULT_BACKOFF_FACTOR = 2;\n/**\r\n * The maximum milliseconds to increase to.\r\n *\r\n * <p>Visible for testing\r\n */\nvar MAX_VALUE_MILLIS = 4 * 60 * 60 * 1000; // Four hours, like iOS and Android.\n/**\r\n * The percentage of backoff time to randomize by.\r\n * See\r\n * http://go/safe-client-behavior#step-1-determine-the-appropriate-retry-interval-to-handle-spike-traffic\r\n * for context.\r\n *\r\n * <p>Visible for testing\r\n */\nvar RANDOM_FACTOR = 0.5;\n/**\r\n * Based on the backoff method from\r\n * https://github.com/google/closure-library/blob/master/closure/goog/math/exponentialbackoff.js.\r\n * Extracted here so we don't need to pass metadata and a stateful ExponentialBackoff object around.\r\n */\nfunction calculateBackoffMillis(backoffCount, intervalMillis, backoffFactor) {\n  if (intervalMillis === void 0) {\n    intervalMillis = DEFAULT_INTERVAL_MILLIS;\n  }\n  if (backoffFactor === void 0) {\n    backoffFactor = DEFAULT_BACKOFF_FACTOR;\n  }\n  // Calculates an exponentially increasing value.\n  // Deviation: calculates value from count and a constant interval, so we only need to save value\n  // and count to restore state.\n  var currBaseValue = intervalMillis * Math.pow(backoffFactor, backoffCount);\n  // A random \"fuzz\" to avoid waves of retries.\n  // Deviation: randomFactor is required.\n  var randomWait = Math.round(\n  // A fraction of the backoff value to add/subtract.\n  // Deviation: changes multiplication order to improve readability.\n  RANDOM_FACTOR * currBaseValue * (\n  // A random float (rounded to int by Math.round above) in the range [-1, 1]. Determines\n  // if we add or subtract.\n  Math.random() - 0.5) * 2);\n  // Limits backoff to max to avoid effectively permanent backoff.\n  return Math.min(MAX_VALUE_MILLIS, currBaseValue + randomWait);\n}\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n/**\r\n * Provide English ordinal letters after a number\r\n */\nfunction ordinal(i) {\n  if (!Number.isFinite(i)) {\n    return \"\" + i;\n  }\n  return i + indicator(i);\n}\nfunction indicator(i) {\n  i = Math.abs(i);\n  var cent = i % 100;\n  if (cent >= 10 && cent <= 20) {\n    return 'th';\n  }\n  var dec = i % 10;\n  if (dec === 1) {\n    return 'st';\n  }\n  if (dec === 2) {\n    return 'nd';\n  }\n  if (dec === 3) {\n    return 'rd';\n  }\n  return 'th';\n}\n\n/**\r\n * @license\r\n * Copyright 2021 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\nfunction getModularInstance(service) {\n  if (service && service._delegate) {\n    return service._delegate;\n  } else {\n    return service;\n  }\n}\nexport { CONSTANTS, Deferred, ErrorFactory, FirebaseError, MAX_VALUE_MILLIS, RANDOM_FACTOR, Sha1, areCookiesEnabled, assert, assertionError, async, base64, base64Decode, base64Encode, base64urlEncodeWithoutPadding, calculateBackoffMillis, contains, createMockUserToken, createSubscribe, decode, deepCopy, deepEqual, deepExtend, errorPrefix, extractQuerystring, getGlobal, getModularInstance, getUA, isAdmin, isBrowser, isBrowserExtension, isElectron, isEmpty, isIE, isIndexedDBAvailable, isMobileCordova, isNode, isNodeSdk, isReactNative, isSafari, isUWP, isValidFormat, isValidTimestamp, issuedAtTime, jsonEval, map, ordinal, querystring, querystringDecode, safeGet, stringLength, stringToByteArray, stringify, validateArgCount, validateCallback, validateContextObject, validateIndexedDBOpenable, validateNamespace };","map":{"version":3,"names":["__assign","__extends","CONSTANTS","NODE_CLIENT","NODE_ADMIN","SDK_VERSION","assert","assertion","message","assertionError","Error","stringToByteArray$1","str","out","p","i","length","c","charCodeAt","byteArrayToString","bytes","pos","c1","String","fromCharCode","c2","c3","c4","u","join","base64","byteToCharMap_","charToByteMap_","byteToCharMapWebSafe_","charToByteMapWebSafe_","ENCODED_VALS_BASE","ENCODED_VALS","ENCODED_VALS_WEBSAFE","HAS_NATIVE_SUPPORT","atob","encodeByteArray","input","webSafe","Array","isArray","init_","byteToCharMap","output","byte1","haveByte2","byte2","haveByte3","byte3","outByte1","outByte2","outByte3","outByte4","push","encodeString","btoa","decodeString","decodeStringToByteArray","charToByteMap","charAt","haveByte4","byte4","base64Encode","utf8Bytes","base64urlEncodeWithoutPadding","replace","base64Decode","e","console","error","deepCopy","value","deepExtend","undefined","target","source","Object","constructor","Date","dateValue","getTime","prop","hasOwnProperty","isValidKey","key","Deferred","_this","reject","resolve","promise","Promise","prototype","wrapCallback","callback","catch","createMockUserToken","token","projectId","uid","header","alg","type","project","iat","sub","user_id","payload","iss","aud","exp","auth_time","firebase","sign_in_provider","identities","signature","JSON","stringify","getUA","navigator","isMobileCordova","window","test","isNode","toString","call","global","process","isBrowser","self","isBrowserExtension","runtime","chrome","browser","id","isReactNative","isElectron","indexOf","isIE","ua","isUWP","isNodeSdk","isSafari","userAgent","includes","isIndexedDBAvailable","indexedDB","validateIndexedDBOpenable","preExist_1","DB_CHECK_NAME_1","request_1","open","onsuccess","result","close","deleteDatabase","onupgradeneeded","onerror","_a","areCookiesEnabled","cookieEnabled","getGlobal","ERROR_NAME","FirebaseError","_super","code","customData","name","setPrototypeOf","captureStackTrace","ErrorFactory","create","service","serviceName","errors","data","_i","arguments","fullCode","template","replaceTemplate","fullMessage","PATTERN","_","jsonEval","parse","decode","claims","parts","split","isValidTimestamp","now","Math","floor","validSince","validUntil","issuedAtTime","isValidFormat","decoded","isAdmin","contains","obj","safeGet","isEmpty","map","fn","contextObj","res","deepEqual","a","b","aKeys","keys","bKeys","aKeys_1","k","aProp","bProp","isObject","bKeys_1","thing","querystring","querystringParams","params","_loop_1","forEach","arrayVal","encodeURIComponent","entries","_b","querystringDecode","tokens","decodeURIComponent","extractQuerystring","url","queryStart","fragmentStart","substring","Sha1","chain_","buf_","W_","pad_","inbuf_","total_","blockSize","reset","compress_","buf","offset","W","t","d","f","update","lengthMinusBlock","n","inbuf","digest","totalBits","j","createSubscribe","executor","onNoObservers","proxy","ObserverProxy","subscribe","bind","observers","unsubscribes","observerCount","task","finalized","then","next","forEachObserver","observer","complete","nextOrObserver","implementsAnyMethods","noop","unsub","unsubscribeOne","finalError","sendOne","err","async","onError","args","apply","methods","methods_1","method","validateArgCount","fnName","minCount","maxCount","argCount","argError","errorPrefix","argName","validateNamespace","namespace","optional","validateCallback","argumentName","validateContextObject","context","stringToByteArray","high","low","stringLength","DEFAULT_INTERVAL_MILLIS","DEFAULT_BACKOFF_FACTOR","MAX_VALUE_MILLIS","RANDOM_FACTOR","calculateBackoffMillis","backoffCount","intervalMillis","backoffFactor","currBaseValue","pow","randomWait","round","random","min","ordinal","Number","isFinite","indicator","abs","cent","dec","getModularInstance","_delegate"],"sources":["C:/Users/CSEG/Desktop/thassign/node_modules/@firebase/util/dist/index.esm.js"],"sourcesContent":["import { __assign, __extends } from 'tslib';\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * @fileoverview Firebase constants.  Some of these (@defines) can be overridden at compile-time.\r\n */\r\nvar CONSTANTS = {\r\n    /**\r\n     * @define {boolean} Whether this is the client Node.js SDK.\r\n     */\r\n    NODE_CLIENT: false,\r\n    /**\r\n     * @define {boolean} Whether this is the Admin Node.js SDK.\r\n     */\r\n    NODE_ADMIN: false,\r\n    /**\r\n     * Firebase SDK Version\r\n     */\r\n    SDK_VERSION: '${JSCORE_VERSION}'\r\n};\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Throws an error if the provided assertion is falsy\r\n */\r\nvar assert = function (assertion, message) {\r\n    if (!assertion) {\r\n        throw assertionError(message);\r\n    }\r\n};\r\n/**\r\n * Returns an Error object suitable for throwing.\r\n */\r\nvar assertionError = function (message) {\r\n    return new Error('Firebase Database (' +\r\n        CONSTANTS.SDK_VERSION +\r\n        ') INTERNAL ASSERT FAILED: ' +\r\n        message);\r\n};\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nvar stringToByteArray$1 = function (str) {\r\n    // TODO(user): Use native implementations if/when available\r\n    var out = [];\r\n    var p = 0;\r\n    for (var i = 0; i < str.length; i++) {\r\n        var c = str.charCodeAt(i);\r\n        if (c < 128) {\r\n            out[p++] = c;\r\n        }\r\n        else if (c < 2048) {\r\n            out[p++] = (c >> 6) | 192;\r\n            out[p++] = (c & 63) | 128;\r\n        }\r\n        else if ((c & 0xfc00) === 0xd800 &&\r\n            i + 1 < str.length &&\r\n            (str.charCodeAt(i + 1) & 0xfc00) === 0xdc00) {\r\n            // Surrogate Pair\r\n            c = 0x10000 + ((c & 0x03ff) << 10) + (str.charCodeAt(++i) & 0x03ff);\r\n            out[p++] = (c >> 18) | 240;\r\n            out[p++] = ((c >> 12) & 63) | 128;\r\n            out[p++] = ((c >> 6) & 63) | 128;\r\n            out[p++] = (c & 63) | 128;\r\n        }\r\n        else {\r\n            out[p++] = (c >> 12) | 224;\r\n            out[p++] = ((c >> 6) & 63) | 128;\r\n            out[p++] = (c & 63) | 128;\r\n        }\r\n    }\r\n    return out;\r\n};\r\n/**\r\n * Turns an array of numbers into the string given by the concatenation of the\r\n * characters to which the numbers correspond.\r\n * @param bytes Array of numbers representing characters.\r\n * @return Stringification of the array.\r\n */\r\nvar byteArrayToString = function (bytes) {\r\n    // TODO(user): Use native implementations if/when available\r\n    var out = [];\r\n    var pos = 0, c = 0;\r\n    while (pos < bytes.length) {\r\n        var c1 = bytes[pos++];\r\n        if (c1 < 128) {\r\n            out[c++] = String.fromCharCode(c1);\r\n        }\r\n        else if (c1 > 191 && c1 < 224) {\r\n            var c2 = bytes[pos++];\r\n            out[c++] = String.fromCharCode(((c1 & 31) << 6) | (c2 & 63));\r\n        }\r\n        else if (c1 > 239 && c1 < 365) {\r\n            // Surrogate Pair\r\n            var c2 = bytes[pos++];\r\n            var c3 = bytes[pos++];\r\n            var c4 = bytes[pos++];\r\n            var u = (((c1 & 7) << 18) | ((c2 & 63) << 12) | ((c3 & 63) << 6) | (c4 & 63)) -\r\n                0x10000;\r\n            out[c++] = String.fromCharCode(0xd800 + (u >> 10));\r\n            out[c++] = String.fromCharCode(0xdc00 + (u & 1023));\r\n        }\r\n        else {\r\n            var c2 = bytes[pos++];\r\n            var c3 = bytes[pos++];\r\n            out[c++] = String.fromCharCode(((c1 & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));\r\n        }\r\n    }\r\n    return out.join('');\r\n};\r\n// We define it as an object literal instead of a class because a class compiled down to es5 can't\r\n// be treeshaked. https://github.com/rollup/rollup/issues/1691\r\n// Static lookup maps, lazily populated by init_()\r\nvar base64 = {\r\n    /**\r\n     * Maps bytes to characters.\r\n     */\r\n    byteToCharMap_: null,\r\n    /**\r\n     * Maps characters to bytes.\r\n     */\r\n    charToByteMap_: null,\r\n    /**\r\n     * Maps bytes to websafe characters.\r\n     * @private\r\n     */\r\n    byteToCharMapWebSafe_: null,\r\n    /**\r\n     * Maps websafe characters to bytes.\r\n     * @private\r\n     */\r\n    charToByteMapWebSafe_: null,\r\n    /**\r\n     * Our default alphabet, shared between\r\n     * ENCODED_VALS and ENCODED_VALS_WEBSAFE\r\n     */\r\n    ENCODED_VALS_BASE: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' + 'abcdefghijklmnopqrstuvwxyz' + '0123456789',\r\n    /**\r\n     * Our default alphabet. Value 64 (=) is special; it means \"nothing.\"\r\n     */\r\n    get ENCODED_VALS() {\r\n        return this.ENCODED_VALS_BASE + '+/=';\r\n    },\r\n    /**\r\n     * Our websafe alphabet.\r\n     */\r\n    get ENCODED_VALS_WEBSAFE() {\r\n        return this.ENCODED_VALS_BASE + '-_.';\r\n    },\r\n    /**\r\n     * Whether this browser supports the atob and btoa functions. This extension\r\n     * started at Mozilla but is now implemented by many browsers. We use the\r\n     * ASSUME_* variables to avoid pulling in the full useragent detection library\r\n     * but still allowing the standard per-browser compilations.\r\n     *\r\n     */\r\n    HAS_NATIVE_SUPPORT: typeof atob === 'function',\r\n    /**\r\n     * Base64-encode an array of bytes.\r\n     *\r\n     * @param input An array of bytes (numbers with\r\n     *     value in [0, 255]) to encode.\r\n     * @param webSafe Boolean indicating we should use the\r\n     *     alternative alphabet.\r\n     * @return The base64 encoded string.\r\n     */\r\n    encodeByteArray: function (input, webSafe) {\r\n        if (!Array.isArray(input)) {\r\n            throw Error('encodeByteArray takes an array as a parameter');\r\n        }\r\n        this.init_();\r\n        var byteToCharMap = webSafe\r\n            ? this.byteToCharMapWebSafe_\r\n            : this.byteToCharMap_;\r\n        var output = [];\r\n        for (var i = 0; i < input.length; i += 3) {\r\n            var byte1 = input[i];\r\n            var haveByte2 = i + 1 < input.length;\r\n            var byte2 = haveByte2 ? input[i + 1] : 0;\r\n            var haveByte3 = i + 2 < input.length;\r\n            var byte3 = haveByte3 ? input[i + 2] : 0;\r\n            var outByte1 = byte1 >> 2;\r\n            var outByte2 = ((byte1 & 0x03) << 4) | (byte2 >> 4);\r\n            var outByte3 = ((byte2 & 0x0f) << 2) | (byte3 >> 6);\r\n            var outByte4 = byte3 & 0x3f;\r\n            if (!haveByte3) {\r\n                outByte4 = 64;\r\n                if (!haveByte2) {\r\n                    outByte3 = 64;\r\n                }\r\n            }\r\n            output.push(byteToCharMap[outByte1], byteToCharMap[outByte2], byteToCharMap[outByte3], byteToCharMap[outByte4]);\r\n        }\r\n        return output.join('');\r\n    },\r\n    /**\r\n     * Base64-encode a string.\r\n     *\r\n     * @param input A string to encode.\r\n     * @param webSafe If true, we should use the\r\n     *     alternative alphabet.\r\n     * @return The base64 encoded string.\r\n     */\r\n    encodeString: function (input, webSafe) {\r\n        // Shortcut for Mozilla browsers that implement\r\n        // a native base64 encoder in the form of \"btoa/atob\"\r\n        if (this.HAS_NATIVE_SUPPORT && !webSafe) {\r\n            return btoa(input);\r\n        }\r\n        return this.encodeByteArray(stringToByteArray$1(input), webSafe);\r\n    },\r\n    /**\r\n     * Base64-decode a string.\r\n     *\r\n     * @param input to decode.\r\n     * @param webSafe True if we should use the\r\n     *     alternative alphabet.\r\n     * @return string representing the decoded value.\r\n     */\r\n    decodeString: function (input, webSafe) {\r\n        // Shortcut for Mozilla browsers that implement\r\n        // a native base64 encoder in the form of \"btoa/atob\"\r\n        if (this.HAS_NATIVE_SUPPORT && !webSafe) {\r\n            return atob(input);\r\n        }\r\n        return byteArrayToString(this.decodeStringToByteArray(input, webSafe));\r\n    },\r\n    /**\r\n     * Base64-decode a string.\r\n     *\r\n     * In base-64 decoding, groups of four characters are converted into three\r\n     * bytes.  If the encoder did not apply padding, the input length may not\r\n     * be a multiple of 4.\r\n     *\r\n     * In this case, the last group will have fewer than 4 characters, and\r\n     * padding will be inferred.  If the group has one or two characters, it decodes\r\n     * to one byte.  If the group has three characters, it decodes to two bytes.\r\n     *\r\n     * @param input Input to decode.\r\n     * @param webSafe True if we should use the web-safe alphabet.\r\n     * @return bytes representing the decoded value.\r\n     */\r\n    decodeStringToByteArray: function (input, webSafe) {\r\n        this.init_();\r\n        var charToByteMap = webSafe\r\n            ? this.charToByteMapWebSafe_\r\n            : this.charToByteMap_;\r\n        var output = [];\r\n        for (var i = 0; i < input.length;) {\r\n            var byte1 = charToByteMap[input.charAt(i++)];\r\n            var haveByte2 = i < input.length;\r\n            var byte2 = haveByte2 ? charToByteMap[input.charAt(i)] : 0;\r\n            ++i;\r\n            var haveByte3 = i < input.length;\r\n            var byte3 = haveByte3 ? charToByteMap[input.charAt(i)] : 64;\r\n            ++i;\r\n            var haveByte4 = i < input.length;\r\n            var byte4 = haveByte4 ? charToByteMap[input.charAt(i)] : 64;\r\n            ++i;\r\n            if (byte1 == null || byte2 == null || byte3 == null || byte4 == null) {\r\n                throw Error();\r\n            }\r\n            var outByte1 = (byte1 << 2) | (byte2 >> 4);\r\n            output.push(outByte1);\r\n            if (byte3 !== 64) {\r\n                var outByte2 = ((byte2 << 4) & 0xf0) | (byte3 >> 2);\r\n                output.push(outByte2);\r\n                if (byte4 !== 64) {\r\n                    var outByte3 = ((byte3 << 6) & 0xc0) | byte4;\r\n                    output.push(outByte3);\r\n                }\r\n            }\r\n        }\r\n        return output;\r\n    },\r\n    /**\r\n     * Lazy static initialization function. Called before\r\n     * accessing any of the static map variables.\r\n     * @private\r\n     */\r\n    init_: function () {\r\n        if (!this.byteToCharMap_) {\r\n            this.byteToCharMap_ = {};\r\n            this.charToByteMap_ = {};\r\n            this.byteToCharMapWebSafe_ = {};\r\n            this.charToByteMapWebSafe_ = {};\r\n            // We want quick mappings back and forth, so we precompute two maps.\r\n            for (var i = 0; i < this.ENCODED_VALS.length; i++) {\r\n                this.byteToCharMap_[i] = this.ENCODED_VALS.charAt(i);\r\n                this.charToByteMap_[this.byteToCharMap_[i]] = i;\r\n                this.byteToCharMapWebSafe_[i] = this.ENCODED_VALS_WEBSAFE.charAt(i);\r\n                this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]] = i;\r\n                // Be forgiving when decoding and correctly decode both encodings.\r\n                if (i >= this.ENCODED_VALS_BASE.length) {\r\n                    this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)] = i;\r\n                    this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)] = i;\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n/**\r\n * URL-safe base64 encoding\r\n */\r\nvar base64Encode = function (str) {\r\n    var utf8Bytes = stringToByteArray$1(str);\r\n    return base64.encodeByteArray(utf8Bytes, true);\r\n};\r\n/**\r\n * URL-safe base64 encoding (without \".\" padding in the end).\r\n * e.g. Used in JSON Web Token (JWT) parts.\r\n */\r\nvar base64urlEncodeWithoutPadding = function (str) {\r\n    // Use base64url encoding and remove padding in the end (dot characters).\r\n    return base64Encode(str).replace(/\\./g, '');\r\n};\r\n/**\r\n * URL-safe base64 decoding\r\n *\r\n * NOTE: DO NOT use the global atob() function - it does NOT support the\r\n * base64Url variant encoding.\r\n *\r\n * @param str To be decoded\r\n * @return Decoded result, if possible\r\n */\r\nvar base64Decode = function (str) {\r\n    try {\r\n        return base64.decodeString(str, true);\r\n    }\r\n    catch (e) {\r\n        console.error('base64Decode failed: ', e);\r\n    }\r\n    return null;\r\n};\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Do a deep-copy of basic JavaScript Objects or Arrays.\r\n */\r\nfunction deepCopy(value) {\r\n    return deepExtend(undefined, value);\r\n}\r\n/**\r\n * Copy properties from source to target (recursively allows extension\r\n * of Objects and Arrays).  Scalar values in the target are over-written.\r\n * If target is undefined, an object of the appropriate type will be created\r\n * (and returned).\r\n *\r\n * We recursively copy all child properties of plain Objects in the source- so\r\n * that namespace- like dictionaries are merged.\r\n *\r\n * Note that the target can be a function, in which case the properties in\r\n * the source Object are copied onto it as static properties of the Function.\r\n *\r\n * Note: we don't merge __proto__ to prevent prototype pollution\r\n */\r\nfunction deepExtend(target, source) {\r\n    if (!(source instanceof Object)) {\r\n        return source;\r\n    }\r\n    switch (source.constructor) {\r\n        case Date:\r\n            // Treat Dates like scalars; if the target date object had any child\r\n            // properties - they will be lost!\r\n            var dateValue = source;\r\n            return new Date(dateValue.getTime());\r\n        case Object:\r\n            if (target === undefined) {\r\n                target = {};\r\n            }\r\n            break;\r\n        case Array:\r\n            // Always copy the array source and overwrite the target.\r\n            target = [];\r\n            break;\r\n        default:\r\n            // Not a plain Object - treat it as a scalar.\r\n            return source;\r\n    }\r\n    for (var prop in source) {\r\n        // use isValidKey to guard against prototype pollution. See https://snyk.io/vuln/SNYK-JS-LODASH-450202\r\n        if (!source.hasOwnProperty(prop) || !isValidKey(prop)) {\r\n            continue;\r\n        }\r\n        target[prop] = deepExtend(target[prop], source[prop]);\r\n    }\r\n    return target;\r\n}\r\nfunction isValidKey(key) {\r\n    return key !== '__proto__';\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nvar Deferred = /** @class */ (function () {\r\n    function Deferred() {\r\n        var _this = this;\r\n        this.reject = function () { };\r\n        this.resolve = function () { };\r\n        this.promise = new Promise(function (resolve, reject) {\r\n            _this.resolve = resolve;\r\n            _this.reject = reject;\r\n        });\r\n    }\r\n    /**\r\n     * Our API internals are not promiseified and cannot because our callback APIs have subtle expectations around\r\n     * invoking promises inline, which Promises are forbidden to do. This method accepts an optional node-style callback\r\n     * and returns a node-style callback which will resolve or reject the Deferred's promise.\r\n     */\r\n    Deferred.prototype.wrapCallback = function (callback) {\r\n        var _this = this;\r\n        return function (error, value) {\r\n            if (error) {\r\n                _this.reject(error);\r\n            }\r\n            else {\r\n                _this.resolve(value);\r\n            }\r\n            if (typeof callback === 'function') {\r\n                // Attaching noop handler just in case developer wasn't expecting\r\n                // promises\r\n                _this.promise.catch(function () { });\r\n                // Some of our callbacks don't expect a value and our own tests\r\n                // assert that the parameter length is 1\r\n                if (callback.length === 1) {\r\n                    callback(error);\r\n                }\r\n                else {\r\n                    callback(error, value);\r\n                }\r\n            }\r\n        };\r\n    };\r\n    return Deferred;\r\n}());\n\n/**\r\n * @license\r\n * Copyright 2021 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction createMockUserToken(token, projectId) {\r\n    if (token.uid) {\r\n        throw new Error('The \"uid\" field is no longer supported by mockUserToken. Please use \"sub\" instead for Firebase Auth User ID.');\r\n    }\r\n    // Unsecured JWTs use \"none\" as the algorithm.\r\n    var header = {\r\n        alg: 'none',\r\n        type: 'JWT'\r\n    };\r\n    var project = projectId || 'demo-project';\r\n    var iat = token.iat || 0;\r\n    var sub = token.sub || token.user_id;\r\n    if (!sub) {\r\n        throw new Error(\"mockUserToken must contain 'sub' or 'user_id' field!\");\r\n    }\r\n    var payload = __assign({ \r\n        // Set all required fields to decent defaults\r\n        iss: \"https://securetoken.google.com/\" + project, aud: project, iat: iat, exp: iat + 3600, auth_time: iat, sub: sub, user_id: sub, firebase: {\r\n            sign_in_provider: 'custom',\r\n            identities: {}\r\n        } }, token);\r\n    // Unsecured JWTs use the empty string as a signature.\r\n    var signature = '';\r\n    return [\r\n        base64urlEncodeWithoutPadding(JSON.stringify(header)),\r\n        base64urlEncodeWithoutPadding(JSON.stringify(payload)),\r\n        signature\r\n    ].join('.');\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Returns navigator.userAgent string or '' if it's not defined.\r\n * @return user agent string\r\n */\r\nfunction getUA() {\r\n    if (typeof navigator !== 'undefined' &&\r\n        typeof navigator['userAgent'] === 'string') {\r\n        return navigator['userAgent'];\r\n    }\r\n    else {\r\n        return '';\r\n    }\r\n}\r\n/**\r\n * Detect Cordova / PhoneGap / Ionic frameworks on a mobile device.\r\n *\r\n * Deliberately does not rely on checking `file://` URLs (as this fails PhoneGap\r\n * in the Ripple emulator) nor Cordova `onDeviceReady`, which would normally\r\n * wait for a callback.\r\n */\r\nfunction isMobileCordova() {\r\n    return (typeof window !== 'undefined' &&\r\n        // @ts-ignore Setting up an broadly applicable index signature for Window\r\n        // just to deal with this case would probably be a bad idea.\r\n        !!(window['cordova'] || window['phonegap'] || window['PhoneGap']) &&\r\n        /ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA()));\r\n}\r\n/**\r\n * Detect Node.js.\r\n *\r\n * @return true if Node.js environment is detected.\r\n */\r\n// Node detection logic from: https://github.com/iliakan/detect-node/\r\nfunction isNode() {\r\n    try {\r\n        return (Object.prototype.toString.call(global.process) === '[object process]');\r\n    }\r\n    catch (e) {\r\n        return false;\r\n    }\r\n}\r\n/**\r\n * Detect Browser Environment\r\n */\r\nfunction isBrowser() {\r\n    return typeof self === 'object' && self.self === self;\r\n}\r\nfunction isBrowserExtension() {\r\n    var runtime = typeof chrome === 'object'\r\n        ? chrome.runtime\r\n        : typeof browser === 'object'\r\n            ? browser.runtime\r\n            : undefined;\r\n    return typeof runtime === 'object' && runtime.id !== undefined;\r\n}\r\n/**\r\n * Detect React Native.\r\n *\r\n * @return true if ReactNative environment is detected.\r\n */\r\nfunction isReactNative() {\r\n    return (typeof navigator === 'object' && navigator['product'] === 'ReactNative');\r\n}\r\n/** Detects Electron apps. */\r\nfunction isElectron() {\r\n    return getUA().indexOf('Electron/') >= 0;\r\n}\r\n/** Detects Internet Explorer. */\r\nfunction isIE() {\r\n    var ua = getUA();\r\n    return ua.indexOf('MSIE ') >= 0 || ua.indexOf('Trident/') >= 0;\r\n}\r\n/** Detects Universal Windows Platform apps. */\r\nfunction isUWP() {\r\n    return getUA().indexOf('MSAppHost/') >= 0;\r\n}\r\n/**\r\n * Detect whether the current SDK build is the Node version.\r\n *\r\n * @return true if it's the Node SDK build.\r\n */\r\nfunction isNodeSdk() {\r\n    return CONSTANTS.NODE_CLIENT === true || CONSTANTS.NODE_ADMIN === true;\r\n}\r\n/** Returns true if we are running in Safari. */\r\nfunction isSafari() {\r\n    return (!isNode() &&\r\n        navigator.userAgent.includes('Safari') &&\r\n        !navigator.userAgent.includes('Chrome'));\r\n}\r\n/**\r\n * This method checks if indexedDB is supported by current browser/service worker context\r\n * @return true if indexedDB is supported by current browser/service worker context\r\n */\r\nfunction isIndexedDBAvailable() {\r\n    return 'indexedDB' in self && indexedDB != null;\r\n}\r\n/**\r\n * This method validates browser/sw context for indexedDB by opening a dummy indexedDB database and reject\r\n * if errors occur during the database open operation.\r\n *\r\n * @throws exception if current browser/sw context can't run idb.open (ex: Safari iframe, Firefox\r\n * private browsing)\r\n */\r\nfunction validateIndexedDBOpenable() {\r\n    return new Promise(function (resolve, reject) {\r\n        try {\r\n            var preExist_1 = true;\r\n            var DB_CHECK_NAME_1 = 'validate-browser-context-for-indexeddb-analytics-module';\r\n            var request_1 = self.indexedDB.open(DB_CHECK_NAME_1);\r\n            request_1.onsuccess = function () {\r\n                request_1.result.close();\r\n                // delete database only when it doesn't pre-exist\r\n                if (!preExist_1) {\r\n                    self.indexedDB.deleteDatabase(DB_CHECK_NAME_1);\r\n                }\r\n                resolve(true);\r\n            };\r\n            request_1.onupgradeneeded = function () {\r\n                preExist_1 = false;\r\n            };\r\n            request_1.onerror = function () {\r\n                var _a;\r\n                reject(((_a = request_1.error) === null || _a === void 0 ? void 0 : _a.message) || '');\r\n            };\r\n        }\r\n        catch (error) {\r\n            reject(error);\r\n        }\r\n    });\r\n}\r\n/**\r\n *\r\n * This method checks whether cookie is enabled within current browser\r\n * @return true if cookie is enabled within current browser\r\n */\r\nfunction areCookiesEnabled() {\r\n    if (!navigator || !navigator.cookieEnabled) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n/**\r\n * Polyfill for `globalThis` object.\r\n * @returns the `globalThis` object for the given environment.\r\n */\r\nfunction getGlobal() {\r\n    if (typeof self !== 'undefined') {\r\n        return self;\r\n    }\r\n    if (typeof window !== 'undefined') {\r\n        return window;\r\n    }\r\n    if (typeof global !== 'undefined') {\r\n        return global;\r\n    }\r\n    throw new Error('Unable to locate global object.');\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nvar ERROR_NAME = 'FirebaseError';\r\n// Based on code from:\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error#Custom_Error_Types\r\nvar FirebaseError = /** @class */ (function (_super) {\r\n    __extends(FirebaseError, _super);\r\n    function FirebaseError(code, message, customData) {\r\n        var _this = _super.call(this, message) || this;\r\n        _this.code = code;\r\n        _this.customData = customData;\r\n        _this.name = ERROR_NAME;\r\n        // Fix For ES5\r\n        // https://github.com/Microsoft/TypeScript-wiki/blob/master/Breaking-Changes.md#extending-built-ins-like-error-array-and-map-may-no-longer-work\r\n        Object.setPrototypeOf(_this, FirebaseError.prototype);\r\n        // Maintains proper stack trace for where our error was thrown.\r\n        // Only available on V8.\r\n        if (Error.captureStackTrace) {\r\n            Error.captureStackTrace(_this, ErrorFactory.prototype.create);\r\n        }\r\n        return _this;\r\n    }\r\n    return FirebaseError;\r\n}(Error));\r\nvar ErrorFactory = /** @class */ (function () {\r\n    function ErrorFactory(service, serviceName, errors) {\r\n        this.service = service;\r\n        this.serviceName = serviceName;\r\n        this.errors = errors;\r\n    }\r\n    ErrorFactory.prototype.create = function (code) {\r\n        var data = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            data[_i - 1] = arguments[_i];\r\n        }\r\n        var customData = data[0] || {};\r\n        var fullCode = this.service + \"/\" + code;\r\n        var template = this.errors[code];\r\n        var message = template ? replaceTemplate(template, customData) : 'Error';\r\n        // Service Name: Error message (service/code).\r\n        var fullMessage = this.serviceName + \": \" + message + \" (\" + fullCode + \").\";\r\n        var error = new FirebaseError(fullCode, fullMessage, customData);\r\n        return error;\r\n    };\r\n    return ErrorFactory;\r\n}());\r\nfunction replaceTemplate(template, data) {\r\n    return template.replace(PATTERN, function (_, key) {\r\n        var value = data[key];\r\n        return value != null ? String(value) : \"<\" + key + \"?>\";\r\n    });\r\n}\r\nvar PATTERN = /\\{\\$([^}]+)}/g;\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Evaluates a JSON string into a javascript object.\r\n *\r\n * @param {string} str A string containing JSON.\r\n * @return {*} The javascript object representing the specified JSON.\r\n */\r\nfunction jsonEval(str) {\r\n    return JSON.parse(str);\r\n}\r\n/**\r\n * Returns JSON representing a javascript object.\r\n * @param {*} data Javascript object to be stringified.\r\n * @return {string} The JSON contents of the object.\r\n */\r\nfunction stringify(data) {\r\n    return JSON.stringify(data);\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Decodes a Firebase auth. token into constituent parts.\r\n *\r\n * Notes:\r\n * - May return with invalid / incomplete claims if there's no native base64 decoding support.\r\n * - Doesn't check if the token is actually valid.\r\n */\r\nvar decode = function (token) {\r\n    var header = {}, claims = {}, data = {}, signature = '';\r\n    try {\r\n        var parts = token.split('.');\r\n        header = jsonEval(base64Decode(parts[0]) || '');\r\n        claims = jsonEval(base64Decode(parts[1]) || '');\r\n        signature = parts[2];\r\n        data = claims['d'] || {};\r\n        delete claims['d'];\r\n    }\r\n    catch (e) { }\r\n    return {\r\n        header: header,\r\n        claims: claims,\r\n        data: data,\r\n        signature: signature\r\n    };\r\n};\r\n/**\r\n * Decodes a Firebase auth. token and checks the validity of its time-based claims. Will return true if the\r\n * token is within the time window authorized by the 'nbf' (not-before) and 'iat' (issued-at) claims.\r\n *\r\n * Notes:\r\n * - May return a false negative if there's no native base64 decoding support.\r\n * - Doesn't check if the token is actually valid.\r\n */\r\nvar isValidTimestamp = function (token) {\r\n    var claims = decode(token).claims;\r\n    var now = Math.floor(new Date().getTime() / 1000);\r\n    var validSince = 0, validUntil = 0;\r\n    if (typeof claims === 'object') {\r\n        if (claims.hasOwnProperty('nbf')) {\r\n            validSince = claims['nbf'];\r\n        }\r\n        else if (claims.hasOwnProperty('iat')) {\r\n            validSince = claims['iat'];\r\n        }\r\n        if (claims.hasOwnProperty('exp')) {\r\n            validUntil = claims['exp'];\r\n        }\r\n        else {\r\n            // token will expire after 24h by default\r\n            validUntil = validSince + 86400;\r\n        }\r\n    }\r\n    return (!!now &&\r\n        !!validSince &&\r\n        !!validUntil &&\r\n        now >= validSince &&\r\n        now <= validUntil);\r\n};\r\n/**\r\n * Decodes a Firebase auth. token and returns its issued at time if valid, null otherwise.\r\n *\r\n * Notes:\r\n * - May return null if there's no native base64 decoding support.\r\n * - Doesn't check if the token is actually valid.\r\n */\r\nvar issuedAtTime = function (token) {\r\n    var claims = decode(token).claims;\r\n    if (typeof claims === 'object' && claims.hasOwnProperty('iat')) {\r\n        return claims['iat'];\r\n    }\r\n    return null;\r\n};\r\n/**\r\n * Decodes a Firebase auth. token and checks the validity of its format. Expects a valid issued-at time.\r\n *\r\n * Notes:\r\n * - May return a false negative if there's no native base64 decoding support.\r\n * - Doesn't check if the token is actually valid.\r\n */\r\nvar isValidFormat = function (token) {\r\n    var decoded = decode(token), claims = decoded.claims;\r\n    return !!claims && typeof claims === 'object' && claims.hasOwnProperty('iat');\r\n};\r\n/**\r\n * Attempts to peer into an auth token and determine if it's an admin auth token by looking at the claims portion.\r\n *\r\n * Notes:\r\n * - May return a false negative if there's no native base64 decoding support.\r\n * - Doesn't check if the token is actually valid.\r\n */\r\nvar isAdmin = function (token) {\r\n    var claims = decode(token).claims;\r\n    return typeof claims === 'object' && claims['admin'] === true;\r\n};\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction contains(obj, key) {\r\n    return Object.prototype.hasOwnProperty.call(obj, key);\r\n}\r\nfunction safeGet(obj, key) {\r\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\r\n        return obj[key];\r\n    }\r\n    else {\r\n        return undefined;\r\n    }\r\n}\r\nfunction isEmpty(obj) {\r\n    for (var key in obj) {\r\n        if (Object.prototype.hasOwnProperty.call(obj, key)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nfunction map(obj, fn, contextObj) {\r\n    var res = {};\r\n    for (var key in obj) {\r\n        if (Object.prototype.hasOwnProperty.call(obj, key)) {\r\n            res[key] = fn.call(contextObj, obj[key], key, obj);\r\n        }\r\n    }\r\n    return res;\r\n}\r\n/**\r\n * Deep equal two objects. Support Arrays and Objects.\r\n */\r\nfunction deepEqual(a, b) {\r\n    if (a === b) {\r\n        return true;\r\n    }\r\n    var aKeys = Object.keys(a);\r\n    var bKeys = Object.keys(b);\r\n    for (var _i = 0, aKeys_1 = aKeys; _i < aKeys_1.length; _i++) {\r\n        var k = aKeys_1[_i];\r\n        if (!bKeys.includes(k)) {\r\n            return false;\r\n        }\r\n        var aProp = a[k];\r\n        var bProp = b[k];\r\n        if (isObject(aProp) && isObject(bProp)) {\r\n            if (!deepEqual(aProp, bProp)) {\r\n                return false;\r\n            }\r\n        }\r\n        else if (aProp !== bProp) {\r\n            return false;\r\n        }\r\n    }\r\n    for (var _a = 0, bKeys_1 = bKeys; _a < bKeys_1.length; _a++) {\r\n        var k = bKeys_1[_a];\r\n        if (!aKeys.includes(k)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nfunction isObject(thing) {\r\n    return thing !== null && typeof thing === 'object';\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Returns a querystring-formatted string (e.g. &arg=val&arg2=val2) from a\r\n * params object (e.g. {arg: 'val', arg2: 'val2'})\r\n * Note: You must prepend it with ? when adding it to a URL.\r\n */\r\nfunction querystring(querystringParams) {\r\n    var params = [];\r\n    var _loop_1 = function (key, value) {\r\n        if (Array.isArray(value)) {\r\n            value.forEach(function (arrayVal) {\r\n                params.push(encodeURIComponent(key) + '=' + encodeURIComponent(arrayVal));\r\n            });\r\n        }\r\n        else {\r\n            params.push(encodeURIComponent(key) + '=' + encodeURIComponent(value));\r\n        }\r\n    };\r\n    for (var _i = 0, _a = Object.entries(querystringParams); _i < _a.length; _i++) {\r\n        var _b = _a[_i], key = _b[0], value = _b[1];\r\n        _loop_1(key, value);\r\n    }\r\n    return params.length ? '&' + params.join('&') : '';\r\n}\r\n/**\r\n * Decodes a querystring (e.g. ?arg=val&arg2=val2) into a params object\r\n * (e.g. {arg: 'val', arg2: 'val2'})\r\n */\r\nfunction querystringDecode(querystring) {\r\n    var obj = {};\r\n    var tokens = querystring.replace(/^\\?/, '').split('&');\r\n    tokens.forEach(function (token) {\r\n        if (token) {\r\n            var _a = token.split('='), key = _a[0], value = _a[1];\r\n            obj[decodeURIComponent(key)] = decodeURIComponent(value);\r\n        }\r\n    });\r\n    return obj;\r\n}\r\n/**\r\n * Extract the query string part of a URL, including the leading question mark (if present).\r\n */\r\nfunction extractQuerystring(url) {\r\n    var queryStart = url.indexOf('?');\r\n    if (!queryStart) {\r\n        return '';\r\n    }\r\n    var fragmentStart = url.indexOf('#', queryStart);\r\n    return url.substring(queryStart, fragmentStart > 0 ? fragmentStart : undefined);\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * @fileoverview SHA-1 cryptographic hash.\r\n * Variable names follow the notation in FIPS PUB 180-3:\r\n * http://csrc.nist.gov/publications/fips/fips180-3/fips180-3_final.pdf.\r\n *\r\n * Usage:\r\n *   var sha1 = new sha1();\r\n *   sha1.update(bytes);\r\n *   var hash = sha1.digest();\r\n *\r\n * Performance:\r\n *   Chrome 23:   ~400 Mbit/s\r\n *   Firefox 16:  ~250 Mbit/s\r\n *\r\n */\r\n/**\r\n * SHA-1 cryptographic hash constructor.\r\n *\r\n * The properties declared here are discussed in the above algorithm document.\r\n * @constructor\r\n * @final\r\n * @struct\r\n */\r\nvar Sha1 = /** @class */ (function () {\r\n    function Sha1() {\r\n        /**\r\n         * Holds the previous values of accumulated variables a-e in the compress_\r\n         * function.\r\n         * @private\r\n         */\r\n        this.chain_ = [];\r\n        /**\r\n         * A buffer holding the partially computed hash result.\r\n         * @private\r\n         */\r\n        this.buf_ = [];\r\n        /**\r\n         * An array of 80 bytes, each a part of the message to be hashed.  Referred to\r\n         * as the message schedule in the docs.\r\n         * @private\r\n         */\r\n        this.W_ = [];\r\n        /**\r\n         * Contains data needed to pad messages less than 64 bytes.\r\n         * @private\r\n         */\r\n        this.pad_ = [];\r\n        /**\r\n         * @private {number}\r\n         */\r\n        this.inbuf_ = 0;\r\n        /**\r\n         * @private {number}\r\n         */\r\n        this.total_ = 0;\r\n        this.blockSize = 512 / 8;\r\n        this.pad_[0] = 128;\r\n        for (var i = 1; i < this.blockSize; ++i) {\r\n            this.pad_[i] = 0;\r\n        }\r\n        this.reset();\r\n    }\r\n    Sha1.prototype.reset = function () {\r\n        this.chain_[0] = 0x67452301;\r\n        this.chain_[1] = 0xefcdab89;\r\n        this.chain_[2] = 0x98badcfe;\r\n        this.chain_[3] = 0x10325476;\r\n        this.chain_[4] = 0xc3d2e1f0;\r\n        this.inbuf_ = 0;\r\n        this.total_ = 0;\r\n    };\r\n    /**\r\n     * Internal compress helper function.\r\n     * @param buf Block to compress.\r\n     * @param offset Offset of the block in the buffer.\r\n     * @private\r\n     */\r\n    Sha1.prototype.compress_ = function (buf, offset) {\r\n        if (!offset) {\r\n            offset = 0;\r\n        }\r\n        var W = this.W_;\r\n        // get 16 big endian words\r\n        if (typeof buf === 'string') {\r\n            for (var i = 0; i < 16; i++) {\r\n                // TODO(user): [bug 8140122] Recent versions of Safari for Mac OS and iOS\r\n                // have a bug that turns the post-increment ++ operator into pre-increment\r\n                // during JIT compilation.  We have code that depends heavily on SHA-1 for\r\n                // correctness and which is affected by this bug, so I've removed all uses\r\n                // of post-increment ++ in which the result value is used.  We can revert\r\n                // this change once the Safari bug\r\n                // (https://bugs.webkit.org/show_bug.cgi?id=109036) has been fixed and\r\n                // most clients have been updated.\r\n                W[i] =\r\n                    (buf.charCodeAt(offset) << 24) |\r\n                        (buf.charCodeAt(offset + 1) << 16) |\r\n                        (buf.charCodeAt(offset + 2) << 8) |\r\n                        buf.charCodeAt(offset + 3);\r\n                offset += 4;\r\n            }\r\n        }\r\n        else {\r\n            for (var i = 0; i < 16; i++) {\r\n                W[i] =\r\n                    (buf[offset] << 24) |\r\n                        (buf[offset + 1] << 16) |\r\n                        (buf[offset + 2] << 8) |\r\n                        buf[offset + 3];\r\n                offset += 4;\r\n            }\r\n        }\r\n        // expand to 80 words\r\n        for (var i = 16; i < 80; i++) {\r\n            var t = W[i - 3] ^ W[i - 8] ^ W[i - 14] ^ W[i - 16];\r\n            W[i] = ((t << 1) | (t >>> 31)) & 0xffffffff;\r\n        }\r\n        var a = this.chain_[0];\r\n        var b = this.chain_[1];\r\n        var c = this.chain_[2];\r\n        var d = this.chain_[3];\r\n        var e = this.chain_[4];\r\n        var f, k;\r\n        // TODO(user): Try to unroll this loop to speed up the computation.\r\n        for (var i = 0; i < 80; i++) {\r\n            if (i < 40) {\r\n                if (i < 20) {\r\n                    f = d ^ (b & (c ^ d));\r\n                    k = 0x5a827999;\r\n                }\r\n                else {\r\n                    f = b ^ c ^ d;\r\n                    k = 0x6ed9eba1;\r\n                }\r\n            }\r\n            else {\r\n                if (i < 60) {\r\n                    f = (b & c) | (d & (b | c));\r\n                    k = 0x8f1bbcdc;\r\n                }\r\n                else {\r\n                    f = b ^ c ^ d;\r\n                    k = 0xca62c1d6;\r\n                }\r\n            }\r\n            var t = (((a << 5) | (a >>> 27)) + f + e + k + W[i]) & 0xffffffff;\r\n            e = d;\r\n            d = c;\r\n            c = ((b << 30) | (b >>> 2)) & 0xffffffff;\r\n            b = a;\r\n            a = t;\r\n        }\r\n        this.chain_[0] = (this.chain_[0] + a) & 0xffffffff;\r\n        this.chain_[1] = (this.chain_[1] + b) & 0xffffffff;\r\n        this.chain_[2] = (this.chain_[2] + c) & 0xffffffff;\r\n        this.chain_[3] = (this.chain_[3] + d) & 0xffffffff;\r\n        this.chain_[4] = (this.chain_[4] + e) & 0xffffffff;\r\n    };\r\n    Sha1.prototype.update = function (bytes, length) {\r\n        // TODO(johnlenz): tighten the function signature and remove this check\r\n        if (bytes == null) {\r\n            return;\r\n        }\r\n        if (length === undefined) {\r\n            length = bytes.length;\r\n        }\r\n        var lengthMinusBlock = length - this.blockSize;\r\n        var n = 0;\r\n        // Using local instead of member variables gives ~5% speedup on Firefox 16.\r\n        var buf = this.buf_;\r\n        var inbuf = this.inbuf_;\r\n        // The outer while loop should execute at most twice.\r\n        while (n < length) {\r\n            // When we have no data in the block to top up, we can directly process the\r\n            // input buffer (assuming it contains sufficient data). This gives ~25%\r\n            // speedup on Chrome 23 and ~15% speedup on Firefox 16, but requires that\r\n            // the data is provided in large chunks (or in multiples of 64 bytes).\r\n            if (inbuf === 0) {\r\n                while (n <= lengthMinusBlock) {\r\n                    this.compress_(bytes, n);\r\n                    n += this.blockSize;\r\n                }\r\n            }\r\n            if (typeof bytes === 'string') {\r\n                while (n < length) {\r\n                    buf[inbuf] = bytes.charCodeAt(n);\r\n                    ++inbuf;\r\n                    ++n;\r\n                    if (inbuf === this.blockSize) {\r\n                        this.compress_(buf);\r\n                        inbuf = 0;\r\n                        // Jump to the outer loop so we use the full-block optimization.\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                while (n < length) {\r\n                    buf[inbuf] = bytes[n];\r\n                    ++inbuf;\r\n                    ++n;\r\n                    if (inbuf === this.blockSize) {\r\n                        this.compress_(buf);\r\n                        inbuf = 0;\r\n                        // Jump to the outer loop so we use the full-block optimization.\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this.inbuf_ = inbuf;\r\n        this.total_ += length;\r\n    };\r\n    /** @override */\r\n    Sha1.prototype.digest = function () {\r\n        var digest = [];\r\n        var totalBits = this.total_ * 8;\r\n        // Add pad 0x80 0x00*.\r\n        if (this.inbuf_ < 56) {\r\n            this.update(this.pad_, 56 - this.inbuf_);\r\n        }\r\n        else {\r\n            this.update(this.pad_, this.blockSize - (this.inbuf_ - 56));\r\n        }\r\n        // Add # bits.\r\n        for (var i = this.blockSize - 1; i >= 56; i--) {\r\n            this.buf_[i] = totalBits & 255;\r\n            totalBits /= 256; // Don't use bit-shifting here!\r\n        }\r\n        this.compress_(this.buf_);\r\n        var n = 0;\r\n        for (var i = 0; i < 5; i++) {\r\n            for (var j = 24; j >= 0; j -= 8) {\r\n                digest[n] = (this.chain_[i] >> j) & 255;\r\n                ++n;\r\n            }\r\n        }\r\n        return digest;\r\n    };\r\n    return Sha1;\r\n}());\n\n/**\r\n * Helper to make a Subscribe function (just like Promise helps make a\r\n * Thenable).\r\n *\r\n * @param executor Function which can make calls to a single Observer\r\n *     as a proxy.\r\n * @param onNoObservers Callback when count of Observers goes to zero.\r\n */\r\nfunction createSubscribe(executor, onNoObservers) {\r\n    var proxy = new ObserverProxy(executor, onNoObservers);\r\n    return proxy.subscribe.bind(proxy);\r\n}\r\n/**\r\n * Implement fan-out for any number of Observers attached via a subscribe\r\n * function.\r\n */\r\nvar ObserverProxy = /** @class */ (function () {\r\n    /**\r\n     * @param executor Function which can make calls to a single Observer\r\n     *     as a proxy.\r\n     * @param onNoObservers Callback when count of Observers goes to zero.\r\n     */\r\n    function ObserverProxy(executor, onNoObservers) {\r\n        var _this = this;\r\n        this.observers = [];\r\n        this.unsubscribes = [];\r\n        this.observerCount = 0;\r\n        // Micro-task scheduling by calling task.then().\r\n        this.task = Promise.resolve();\r\n        this.finalized = false;\r\n        this.onNoObservers = onNoObservers;\r\n        // Call the executor asynchronously so subscribers that are called\r\n        // synchronously after the creation of the subscribe function\r\n        // can still receive the very first value generated in the executor.\r\n        this.task\r\n            .then(function () {\r\n            executor(_this);\r\n        })\r\n            .catch(function (e) {\r\n            _this.error(e);\r\n        });\r\n    }\r\n    ObserverProxy.prototype.next = function (value) {\r\n        this.forEachObserver(function (observer) {\r\n            observer.next(value);\r\n        });\r\n    };\r\n    ObserverProxy.prototype.error = function (error) {\r\n        this.forEachObserver(function (observer) {\r\n            observer.error(error);\r\n        });\r\n        this.close(error);\r\n    };\r\n    ObserverProxy.prototype.complete = function () {\r\n        this.forEachObserver(function (observer) {\r\n            observer.complete();\r\n        });\r\n        this.close();\r\n    };\r\n    /**\r\n     * Subscribe function that can be used to add an Observer to the fan-out list.\r\n     *\r\n     * - We require that no event is sent to a subscriber sychronously to their\r\n     *   call to subscribe().\r\n     */\r\n    ObserverProxy.prototype.subscribe = function (nextOrObserver, error, complete) {\r\n        var _this = this;\r\n        var observer;\r\n        if (nextOrObserver === undefined &&\r\n            error === undefined &&\r\n            complete === undefined) {\r\n            throw new Error('Missing Observer.');\r\n        }\r\n        // Assemble an Observer object when passed as callback functions.\r\n        if (implementsAnyMethods(nextOrObserver, [\r\n            'next',\r\n            'error',\r\n            'complete'\r\n        ])) {\r\n            observer = nextOrObserver;\r\n        }\r\n        else {\r\n            observer = {\r\n                next: nextOrObserver,\r\n                error: error,\r\n                complete: complete\r\n            };\r\n        }\r\n        if (observer.next === undefined) {\r\n            observer.next = noop;\r\n        }\r\n        if (observer.error === undefined) {\r\n            observer.error = noop;\r\n        }\r\n        if (observer.complete === undefined) {\r\n            observer.complete = noop;\r\n        }\r\n        var unsub = this.unsubscribeOne.bind(this, this.observers.length);\r\n        // Attempt to subscribe to a terminated Observable - we\r\n        // just respond to the Observer with the final error or complete\r\n        // event.\r\n        if (this.finalized) {\r\n            // eslint-disable-next-line @typescript-eslint/no-floating-promises\r\n            this.task.then(function () {\r\n                try {\r\n                    if (_this.finalError) {\r\n                        observer.error(_this.finalError);\r\n                    }\r\n                    else {\r\n                        observer.complete();\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    // nothing\r\n                }\r\n                return;\r\n            });\r\n        }\r\n        this.observers.push(observer);\r\n        return unsub;\r\n    };\r\n    // Unsubscribe is synchronous - we guarantee that no events are sent to\r\n    // any unsubscribed Observer.\r\n    ObserverProxy.prototype.unsubscribeOne = function (i) {\r\n        if (this.observers === undefined || this.observers[i] === undefined) {\r\n            return;\r\n        }\r\n        delete this.observers[i];\r\n        this.observerCount -= 1;\r\n        if (this.observerCount === 0 && this.onNoObservers !== undefined) {\r\n            this.onNoObservers(this);\r\n        }\r\n    };\r\n    ObserverProxy.prototype.forEachObserver = function (fn) {\r\n        if (this.finalized) {\r\n            // Already closed by previous event....just eat the additional values.\r\n            return;\r\n        }\r\n        // Since sendOne calls asynchronously - there is no chance that\r\n        // this.observers will become undefined.\r\n        for (var i = 0; i < this.observers.length; i++) {\r\n            this.sendOne(i, fn);\r\n        }\r\n    };\r\n    // Call the Observer via one of it's callback function. We are careful to\r\n    // confirm that the observe has not been unsubscribed since this asynchronous\r\n    // function had been queued.\r\n    ObserverProxy.prototype.sendOne = function (i, fn) {\r\n        var _this = this;\r\n        // Execute the callback asynchronously\r\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\r\n        this.task.then(function () {\r\n            if (_this.observers !== undefined && _this.observers[i] !== undefined) {\r\n                try {\r\n                    fn(_this.observers[i]);\r\n                }\r\n                catch (e) {\r\n                    // Ignore exceptions raised in Observers or missing methods of an\r\n                    // Observer.\r\n                    // Log error to console. b/31404806\r\n                    if (typeof console !== 'undefined' && console.error) {\r\n                        console.error(e);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    };\r\n    ObserverProxy.prototype.close = function (err) {\r\n        var _this = this;\r\n        if (this.finalized) {\r\n            return;\r\n        }\r\n        this.finalized = true;\r\n        if (err !== undefined) {\r\n            this.finalError = err;\r\n        }\r\n        // Proxy is no longer needed - garbage collect references\r\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\r\n        this.task.then(function () {\r\n            _this.observers = undefined;\r\n            _this.onNoObservers = undefined;\r\n        });\r\n    };\r\n    return ObserverProxy;\r\n}());\r\n/** Turn synchronous function into one called asynchronously. */\r\n// eslint-disable-next-line @typescript-eslint/ban-types\r\nfunction async(fn, onError) {\r\n    return function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        Promise.resolve(true)\r\n            .then(function () {\r\n            fn.apply(void 0, args);\r\n        })\r\n            .catch(function (error) {\r\n            if (onError) {\r\n                onError(error);\r\n            }\r\n        });\r\n    };\r\n}\r\n/**\r\n * Return true if the object passed in implements any of the named methods.\r\n */\r\nfunction implementsAnyMethods(obj, methods) {\r\n    if (typeof obj !== 'object' || obj === null) {\r\n        return false;\r\n    }\r\n    for (var _i = 0, methods_1 = methods; _i < methods_1.length; _i++) {\r\n        var method = methods_1[_i];\r\n        if (method in obj && typeof obj[method] === 'function') {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nfunction noop() {\r\n    // do nothing\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Check to make sure the appropriate number of arguments are provided for a public function.\r\n * Throws an error if it fails.\r\n *\r\n * @param fnName The function name\r\n * @param minCount The minimum number of arguments to allow for the function call\r\n * @param maxCount The maximum number of argument to allow for the function call\r\n * @param argCount The actual number of arguments provided.\r\n */\r\nvar validateArgCount = function (fnName, minCount, maxCount, argCount) {\r\n    var argError;\r\n    if (argCount < minCount) {\r\n        argError = 'at least ' + minCount;\r\n    }\r\n    else if (argCount > maxCount) {\r\n        argError = maxCount === 0 ? 'none' : 'no more than ' + maxCount;\r\n    }\r\n    if (argError) {\r\n        var error = fnName +\r\n            ' failed: Was called with ' +\r\n            argCount +\r\n            (argCount === 1 ? ' argument.' : ' arguments.') +\r\n            ' Expects ' +\r\n            argError +\r\n            '.';\r\n        throw new Error(error);\r\n    }\r\n};\r\n/**\r\n * Generates a string to prefix an error message about failed argument validation\r\n *\r\n * @param fnName The function name\r\n * @param argName The name of the argument\r\n * @return The prefix to add to the error thrown for validation.\r\n */\r\nfunction errorPrefix(fnName, argName) {\r\n    return fnName + \" failed: \" + argName + \" argument \";\r\n}\r\n/**\r\n * @param fnName\r\n * @param argumentNumber\r\n * @param namespace\r\n * @param optional\r\n */\r\nfunction validateNamespace(fnName, namespace, optional) {\r\n    if (optional && !namespace) {\r\n        return;\r\n    }\r\n    if (typeof namespace !== 'string') {\r\n        //TODO: I should do more validation here. We only allow certain chars in namespaces.\r\n        throw new Error(errorPrefix(fnName, 'namespace') + 'must be a valid firebase namespace.');\r\n    }\r\n}\r\nfunction validateCallback(fnName, argumentName, \r\n// eslint-disable-next-line @typescript-eslint/ban-types\r\ncallback, optional) {\r\n    if (optional && !callback) {\r\n        return;\r\n    }\r\n    if (typeof callback !== 'function') {\r\n        throw new Error(errorPrefix(fnName, argumentName) + 'must be a valid function.');\r\n    }\r\n}\r\nfunction validateContextObject(fnName, argumentName, context, optional) {\r\n    if (optional && !context) {\r\n        return;\r\n    }\r\n    if (typeof context !== 'object' || context === null) {\r\n        throw new Error(errorPrefix(fnName, argumentName) + 'must be a valid context object.');\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n// Code originally came from goog.crypt.stringToUtf8ByteArray, but for some reason they\r\n// automatically replaced '\\r\\n' with '\\n', and they didn't handle surrogate pairs,\r\n// so it's been modified.\r\n// Note that not all Unicode characters appear as single characters in JavaScript strings.\r\n// fromCharCode returns the UTF-16 encoding of a character - so some Unicode characters\r\n// use 2 characters in Javascript.  All 4-byte UTF-8 characters begin with a first\r\n// character in the range 0xD800 - 0xDBFF (the first character of a so-called surrogate\r\n// pair).\r\n// See http://www.ecma-international.org/ecma-262/5.1/#sec-15.1.3\r\n/**\r\n * @param {string} str\r\n * @return {Array}\r\n */\r\nvar stringToByteArray = function (str) {\r\n    var out = [];\r\n    var p = 0;\r\n    for (var i = 0; i < str.length; i++) {\r\n        var c = str.charCodeAt(i);\r\n        // Is this the lead surrogate in a surrogate pair?\r\n        if (c >= 0xd800 && c <= 0xdbff) {\r\n            var high = c - 0xd800; // the high 10 bits.\r\n            i++;\r\n            assert(i < str.length, 'Surrogate pair missing trail surrogate.');\r\n            var low = str.charCodeAt(i) - 0xdc00; // the low 10 bits.\r\n            c = 0x10000 + (high << 10) + low;\r\n        }\r\n        if (c < 128) {\r\n            out[p++] = c;\r\n        }\r\n        else if (c < 2048) {\r\n            out[p++] = (c >> 6) | 192;\r\n            out[p++] = (c & 63) | 128;\r\n        }\r\n        else if (c < 65536) {\r\n            out[p++] = (c >> 12) | 224;\r\n            out[p++] = ((c >> 6) & 63) | 128;\r\n            out[p++] = (c & 63) | 128;\r\n        }\r\n        else {\r\n            out[p++] = (c >> 18) | 240;\r\n            out[p++] = ((c >> 12) & 63) | 128;\r\n            out[p++] = ((c >> 6) & 63) | 128;\r\n            out[p++] = (c & 63) | 128;\r\n        }\r\n    }\r\n    return out;\r\n};\r\n/**\r\n * Calculate length without actually converting; useful for doing cheaper validation.\r\n * @param {string} str\r\n * @return {number}\r\n */\r\nvar stringLength = function (str) {\r\n    var p = 0;\r\n    for (var i = 0; i < str.length; i++) {\r\n        var c = str.charCodeAt(i);\r\n        if (c < 128) {\r\n            p++;\r\n        }\r\n        else if (c < 2048) {\r\n            p += 2;\r\n        }\r\n        else if (c >= 0xd800 && c <= 0xdbff) {\r\n            // Lead surrogate of a surrogate pair.  The pair together will take 4 bytes to represent.\r\n            p += 4;\r\n            i++; // skip trail surrogate.\r\n        }\r\n        else {\r\n            p += 3;\r\n        }\r\n    }\r\n    return p;\r\n};\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * The amount of milliseconds to exponentially increase.\r\n */\r\nvar DEFAULT_INTERVAL_MILLIS = 1000;\r\n/**\r\n * The factor to backoff by.\r\n * Should be a number greater than 1.\r\n */\r\nvar DEFAULT_BACKOFF_FACTOR = 2;\r\n/**\r\n * The maximum milliseconds to increase to.\r\n *\r\n * <p>Visible for testing\r\n */\r\nvar MAX_VALUE_MILLIS = 4 * 60 * 60 * 1000; // Four hours, like iOS and Android.\r\n/**\r\n * The percentage of backoff time to randomize by.\r\n * See\r\n * http://go/safe-client-behavior#step-1-determine-the-appropriate-retry-interval-to-handle-spike-traffic\r\n * for context.\r\n *\r\n * <p>Visible for testing\r\n */\r\nvar RANDOM_FACTOR = 0.5;\r\n/**\r\n * Based on the backoff method from\r\n * https://github.com/google/closure-library/blob/master/closure/goog/math/exponentialbackoff.js.\r\n * Extracted here so we don't need to pass metadata and a stateful ExponentialBackoff object around.\r\n */\r\nfunction calculateBackoffMillis(backoffCount, intervalMillis, backoffFactor) {\r\n    if (intervalMillis === void 0) { intervalMillis = DEFAULT_INTERVAL_MILLIS; }\r\n    if (backoffFactor === void 0) { backoffFactor = DEFAULT_BACKOFF_FACTOR; }\r\n    // Calculates an exponentially increasing value.\r\n    // Deviation: calculates value from count and a constant interval, so we only need to save value\r\n    // and count to restore state.\r\n    var currBaseValue = intervalMillis * Math.pow(backoffFactor, backoffCount);\r\n    // A random \"fuzz\" to avoid waves of retries.\r\n    // Deviation: randomFactor is required.\r\n    var randomWait = Math.round(\r\n    // A fraction of the backoff value to add/subtract.\r\n    // Deviation: changes multiplication order to improve readability.\r\n    RANDOM_FACTOR *\r\n        currBaseValue *\r\n        // A random float (rounded to int by Math.round above) in the range [-1, 1]. Determines\r\n        // if we add or subtract.\r\n        (Math.random() - 0.5) *\r\n        2);\r\n    // Limits backoff to max to avoid effectively permanent backoff.\r\n    return Math.min(MAX_VALUE_MILLIS, currBaseValue + randomWait);\r\n}\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Provide English ordinal letters after a number\r\n */\r\nfunction ordinal(i) {\r\n    if (!Number.isFinite(i)) {\r\n        return \"\" + i;\r\n    }\r\n    return i + indicator(i);\r\n}\r\nfunction indicator(i) {\r\n    i = Math.abs(i);\r\n    var cent = i % 100;\r\n    if (cent >= 10 && cent <= 20) {\r\n        return 'th';\r\n    }\r\n    var dec = i % 10;\r\n    if (dec === 1) {\r\n        return 'st';\r\n    }\r\n    if (dec === 2) {\r\n        return 'nd';\r\n    }\r\n    if (dec === 3) {\r\n        return 'rd';\r\n    }\r\n    return 'th';\r\n}\n\n/**\r\n * @license\r\n * Copyright 2021 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction getModularInstance(service) {\r\n    if (service && service._delegate) {\r\n        return service._delegate;\r\n    }\r\n    else {\r\n        return service;\r\n    }\r\n}\n\nexport { CONSTANTS, Deferred, ErrorFactory, FirebaseError, MAX_VALUE_MILLIS, RANDOM_FACTOR, Sha1, areCookiesEnabled, assert, assertionError, async, base64, base64Decode, base64Encode, base64urlEncodeWithoutPadding, calculateBackoffMillis, contains, createMockUserToken, createSubscribe, decode, deepCopy, deepEqual, deepExtend, errorPrefix, extractQuerystring, getGlobal, getModularInstance, getUA, isAdmin, isBrowser, isBrowserExtension, isElectron, isEmpty, isIE, isIndexedDBAvailable, isMobileCordova, isNode, isNodeSdk, isReactNative, isSafari, isUWP, isValidFormat, isValidTimestamp, issuedAtTime, jsonEval, map, ordinal, querystring, querystringDecode, safeGet, stringLength, stringToByteArray, stringify, validateArgCount, validateCallback, validateContextObject, validateIndexedDBOpenable, validateNamespace };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}