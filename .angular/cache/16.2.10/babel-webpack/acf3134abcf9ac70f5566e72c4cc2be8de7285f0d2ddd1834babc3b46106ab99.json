{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/CSEG/Desktop/thassign/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { EventEmitter } from '@angular/core';\nimport { UntypedFormGroup } from '@angular/forms';\nimport { combineLatest } from 'rxjs';\nimport { delay, map, tap } from 'rxjs/operators';\nimport { AssignmentCommon } from '@src/app/modules/assignments/components/assignment.common';\nimport { AssignableListComponent } from '@src/app/modules/assignments/components/assignable-list/assignable-list.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@src/app/modules/assignments/services/assignment.service\";\nimport * as i2 from \"@src/app/core/services/backend.service\";\nimport * as i3 from \"@src/app/core/services/part.service\";\nimport * as i4 from \"@src/app/core/services/program.service\";\nimport * as i5 from \"@ngx-translate/core\";\nimport * as i6 from \"@src/app/modules/users/user.service\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"@angular/forms\";\nimport * as i9 from \"@angular/material/legacy-button\";\nimport * as i10 from \"@angular/material/legacy-chips\";\nimport * as i11 from \"@angular/material/divider\";\nimport * as i12 from \"@angular/material/icon\";\nimport * as i13 from \"@angular/material/legacy-tooltip\";\nimport * as i14 from \"@src/app/shared/components/loader/loader.component\";\nimport * as i15 from \"@src/app/shared/components/picker/picker.component\";\nimport * as i16 from \"@src/app/shared/pipes/translate-date.pipe\";\nimport * as i17 from \"@src/app/shared/pipes/with-loading.pipe\";\nconst _c0 = [\"printableArea\"];\nfunction AssignmentMidweekComponent_app_loader_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-loader\");\n  }\n}\nfunction AssignmentMidweekComponent_div_1_ng_template_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0);\n    i0.ɵɵpipe(1, \"translate\");\n  }\n  if (rf & 2) {\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(1, 1, \"error.general\"));\n  }\n}\nfunction AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_button_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 12);\n    i0.ɵɵlistener(\"click\", function AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_button_1_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r14 = i0.ɵɵnextContext(5);\n      return i0.ɵɵresetView(ctx_r14.cancelEdit());\n    });\n    i0.ɵɵelementStart(1, \"mat-icon\");\n    i0.ɵɵtext(2, \"undo\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\", 13);\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"titlecase\");\n    i0.ɵɵpipe(6, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(5, 1, i0.ɵɵpipeBind1(6, 3, \"cancel\")), \" \");\n  }\n}\nfunction AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_button_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"button\", 14)(1, \"mat-icon\");\n    i0.ɵɵtext(2, \"save\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\", 13);\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"titlecase\");\n    i0.ɵɵpipe(6, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(5, 1, i0.ɵɵpipeBind1(6, 3, \"save\")), \" \");\n  }\n}\nfunction AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_button_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r17 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_button_3_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r17);\n      const ctx_r16 = i0.ɵɵnextContext(5);\n      return i0.ɵɵresetView(ctx_r16.setEditMode(true));\n    });\n    i0.ɵɵelementStart(1, \"mat-icon\");\n    i0.ɵɵtext(2, \"edit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\", 13);\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"titlecase\");\n    i0.ɵɵpipe(6, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(5, 1, i0.ɵɵpipeBind1(6, 3, \"edit\")), \" \");\n  }\n}\nfunction AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_button_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r19 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_button_4_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r19);\n      const ctx_r18 = i0.ɵɵnextContext(5);\n      return i0.ɵɵresetView(ctx_r18.saveAsPdf());\n    });\n    i0.ɵɵelementStart(1, \"mat-icon\");\n    i0.ɵɵtext(2, \"print\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\", 13);\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"titlecase\");\n    i0.ɵɵpipe(6, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(5, 1, i0.ɵɵpipeBind1(6, 3, \"print\")), \" \");\n  }\n}\nfunction AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r21 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 7);\n    i0.ɵɵtemplate(1, AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_button_1_Template, 7, 5, \"button\", 8);\n    i0.ɵɵtemplate(2, AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_button_2_Template, 7, 5, \"button\", 9);\n    i0.ɵɵtemplate(3, AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_button_3_Template, 7, 5, \"button\", 10);\n    i0.ɵɵtemplate(4, AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_button_4_Template, 7, 5, \"button\", 10);\n    i0.ɵɵelementStart(5, \"mat-chip-list\")(6, \"mat-chip\", 11);\n    i0.ɵɵlistener(\"click\", function AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_Template_mat_chip_click_6_listener() {\n      i0.ɵɵrestoreView(_r21);\n      const ctx_r20 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r20.setDisplayStudentsParts(true));\n    });\n    i0.ɵɵtext(7, \" Students Parts \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"mat-chip\", 11);\n    i0.ɵɵlistener(\"click\", function AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_Template_mat_chip_click_8_listener() {\n      i0.ɵɵrestoreView(_r21);\n      const ctx_r22 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r22.setDisplayStudentsParts(false));\n    });\n    i0.ɵɵtext(9, \" Non Students Parts \");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r7 = i0.ɵɵnextContext(4);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r7.isEditMode);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r7.isEditMode);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r7.isEditMode);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r7.isEditMode);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"selected\", ctx_r7.getDisplayStudentsParts() === true);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"selected\", ctx_r7.getDisplayStudentsParts() === false);\n  }\n}\nconst _c1 = function (a0, a2) {\n  return [a0, \"assignments\", a2, \"assistant\"];\n};\nfunction AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_div_1_ng_container_6_div_1_div_3_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 30);\n    i0.ɵɵelement(1, \"app-picker\", 28);\n    i0.ɵɵpipe(2, \"titlecase\");\n    i0.ɵɵpipe(3, \"titlecase\");\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵpipe(5, \"titlecase\");\n    i0.ɵɵpipe(6, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const assignment_r27 = i0.ɵɵnextContext(3).$implicit;\n    const program_r25 = i0.ɵɵnextContext().ngIf;\n    const ctx_r32 = i0.ɵɵnextContext(5);\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate2(\"title\", \"\", i0.ɵɵpipeBind1(2, 7, assignment_r27.title), \" (\", i0.ɵɵpipeBind1(3, 9, i0.ɵɵpipeBind1(4, 11, \"assistant\")), \")\");\n    i0.ɵɵpropertyInterpolate(\"placeholder\", i0.ɵɵpipeBind1(5, 13, i0.ɵɵpipeBind1(6, 15, \"assistant\")));\n    i0.ɵɵproperty(\"optionsTemplate\", ctx_r32.displayComponentRef.componentType)(\"form\", ctx_r32.programsForm)(\"controlPath\", i0.ɵɵpureFunction2(17, _c1, program_r25._id, assignment_r27.position))(\"options\", ctx_r32.assignableListByPart[\"clm.ministry.assistant\"]);\n  }\n}\nconst _c2 = function (a0, a2) {\n  return [a0, \"assignments\", a2, \"assignee\"];\n};\nfunction AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_div_1_ng_container_6_div_1_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 26)(1, \"div\", 27);\n    i0.ɵɵelement(2, \"app-picker\", 28);\n    i0.ɵɵpipe(3, \"titlecase\");\n    i0.ɵɵpipe(4, \"titlecase\");\n    i0.ɵɵpipe(5, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(6, AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_div_1_ng_container_6_div_1_div_3_div_6_Template, 7, 20, \"div\", 29);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const assignment_r27 = i0.ɵɵnextContext(2).$implicit;\n    const program_r25 = i0.ɵɵnextContext().ngIf;\n    const ctx_r29 = i0.ɵɵnextContext(5);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"fxFlex\", assignment_r27.part.withAssistant ? 49 : 100);\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"title\", i0.ɵɵpipeBind1(3, 8, assignment_r27.title));\n    i0.ɵɵpropertyInterpolate(\"placeholder\", i0.ɵɵpipeBind1(4, 10, i0.ɵɵpipeBind1(5, 12, \"assignee\")));\n    i0.ɵɵproperty(\"optionsTemplate\", ctx_r29.displayComponentRef.componentType)(\"form\", ctx_r29.programsForm)(\"controlPath\", i0.ɵɵpureFunction2(14, _c2, program_r25._id, assignment_r27.position))(\"options\", ctx_r29.assignableListByPart[assignment_r27.part.name]);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", assignment_r27.part.withAssistant);\n  }\n}\nfunction AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_div_1_ng_container_6_div_1_ng_template_4_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 34);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const assignment_r27 = i0.ɵɵnextContext(3).$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \\u00A0/\\u00A0\", assignment_r27.assistant == null ? null : assignment_r27.assistant.fullName, \"\");\n  }\n}\nfunction AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_div_1_ng_container_6_div_1_ng_template_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 31)(1, \"span\", 32);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_div_1_ng_container_6_div_1_ng_template_4_span_3_Template, 2, 1, \"span\", 33);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const assignment_r27 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(assignment_r27.assignee == null ? null : assignment_r27.assignee.fullName);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", assignment_r27.assistant);\n  }\n}\nfunction AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_div_1_ng_container_6_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 22)(1, \"div\", 23);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_div_1_ng_container_6_div_1_div_3_Template, 7, 17, \"div\", 24);\n    i0.ɵɵtemplate(4, AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_div_1_ng_container_6_div_1_ng_template_4_Template, 4, 2, \"ng-template\", null, 25, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelement(6, \"mat-divider\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const _r30 = i0.ɵɵreference(5);\n    const assignment_r27 = i0.ɵɵnextContext().$implicit;\n    const ctx_r28 = i0.ɵɵnextContext(6);\n    i0.ɵɵproperty(\"formGroupName\", assignment_r27.position);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"matTooltip\", assignment_r27.description ? assignment_r27.description : null)(\"fxFlex.lt-sm\", ctx_r28.isEditMode ? 100 : null);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", assignment_r27.title, \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r28.isEditMode)(\"ngIfElse\", _r30);\n  }\n}\nfunction AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_div_1_ng_container_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_div_1_ng_container_6_div_1_Template, 7, 6, \"div\", 21);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const assignment_r27 = ctx.$implicit;\n    const ctx_r26 = i0.ɵɵnextContext(6);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r26.isWorkingOnPart(assignment_r27.part));\n  }\n}\nconst _c3 = function (a0, a1) {\n  return {\n    \"week-box-edit\": a0,\n    \"week-box-view\": a1\n  };\n};\nconst _c4 = function () {\n  return {\n    days: 6\n  };\n};\nfunction AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18)(1, \"h2\");\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"async\");\n    i0.ɵɵpipe(4, \"translateDate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 19);\n    i0.ɵɵtemplate(6, AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_div_1_ng_container_6_Template, 2, 1, \"ng-container\", 20);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const program_r25 = ctx.ngIf;\n    const ctx_r24 = i0.ɵɵnextContext(5);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(9, _c3, ctx_r24.isEditMode, !ctx_r24.isEditMode));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(3, 3, i0.ɵɵpipeBind3(4, 5, program_r25.week, \"MMM-D\", i0.ɵɵpureFunction0(12, _c4))));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", program_r25.assignments);\n  }\n}\nfunction AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 16);\n    i0.ɵɵtemplate(1, AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_div_1_Template, 7, 13, \"div\", 17);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const mProgram_r23 = ctx.$implicit;\n    i0.ɵɵproperty(\"formGroupName\", mProgram_r23.key);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", mProgram_r23.value);\n  }\n}\nfunction AssignmentMidweekComponent_div_1_ng_template_2_form_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r42 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"form\", 3);\n    i0.ɵɵlistener(\"ngSubmit\", function AssignmentMidweekComponent_div_1_ng_template_2_form_0_Template_form_ngSubmit_0_listener() {\n      i0.ɵɵrestoreView(_r42);\n      const ctx_r41 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r41.onSubmit());\n    });\n    i0.ɵɵtemplate(1, AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_Template, 10, 6, \"div\", 4);\n    i0.ɵɵtext(2, \" \\u00A0 \");\n    i0.ɵɵelementStart(3, \"div\", null, 5);\n    i0.ɵɵtemplate(5, AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_Template, 2, 2, \"div\", 6);\n    i0.ɵɵpipe(6, \"keyvalue\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const mPrograms_r6 = ctx.ngIf;\n    const ctx_r5 = i0.ɵɵnextContext(3);\n    i0.ɵɵproperty(\"formGroup\", ctx_r5.programsForm);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", mPrograms_r6.size && !ctx_r5.loading);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(6, 3, mPrograms_r6));\n  }\n}\nfunction AssignmentMidweekComponent_div_1_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtemplate(0, AssignmentMidweekComponent_div_1_ng_template_2_form_0_Template, 7, 5, \"form\", 2);\n  }\n  if (rf & 2) {\n    const mProgramsWithLoading_r2 = i0.ɵɵnextContext().ngIf;\n    i0.ɵɵproperty(\"ngIf\", mProgramsWithLoading_r2.value);\n  }\n}\nfunction AssignmentMidweekComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, AssignmentMidweekComponent_div_1_ng_template_1_Template, 2, 3, \"ng-template\", 1);\n    i0.ɵɵtemplate(2, AssignmentMidweekComponent_div_1_ng_template_2_Template, 1, 1, \"ng-template\", 1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const mProgramsWithLoading_r2 = ctx.ngIf;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", mProgramsWithLoading_r2.error);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", mProgramsWithLoading_r2.value);\n  }\n}\nexport class AssignmentMidweekComponent extends AssignmentCommon {\n  constructor(resolver, injector, assignmentService, backendService, partService, programService, translateService, userService) {\n    super();\n    this.resolver = resolver;\n    this.injector = injector;\n    this.assignmentService = assignmentService;\n    this.backendService = backendService;\n    this.partService = partService;\n    this.programService = programService;\n    this.translateService = translateService;\n    this.userService = userService;\n    this.editMode = new EventEmitter();\n    // currentWeek: DateTime;\n    // dateFormat = MY_FORMATS.display.dateA11yLabel;\n    this.meetingName = 'midweek';\n    /**\r\n     * Display the Loading msg\r\n     */\n    this.loading = false;\n  }\n  ngOnInit() {\n    var _this = this;\n    // Pipe to the assignments observable\n    this.data$ = combineLatest([this.userService.data, this.programService.data\n    // this.translateService.onLangChange.asObservable(),\n    ]).subscribe( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* ([users, programs]) {\n        if (users !== null && programs !== null) {\n          // Display form only when observables have started emitting\n          yield _this.initializeData();\n          // Load the assignments of the default month (current)\n          // await this.initializeMonthData();\n          yield _this.programService.getProgramsByMonth('midweek', _this.month);\n          _this.mPrograms$ = _this.programService.mPrograms.pipe(map(v => v === null ? new Map() : v),\n          // Map null to empty map\n          delay(0),\n          // Useful to prevent an error about loading property\n          tap(mPrograms => {\n            _this.mPrograms = mPrograms;\n            // Build the form\n            _this.prepareForm();\n            _this.showLoader(false);\n            _this.subscribeToFormChanges();\n          }));\n        }\n      });\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n    // Getting the template of the picker\n    const componentFactory = this.resolver.resolveComponentFactory(AssignableListComponent);\n    this.displayComponentRef = componentFactory.create(this.injector);\n  }\n  ngOnChanges(changes) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      _this2.showLoader();\n      // Get the first week as the first monday of the month\n      // this.currentWeek = this.month.set({ weekday: 8 });\n      yield _this2.programService.getProgramsByMonth('midweek', _this2.month);\n      // Check if the previous form was in edit mode : useful ??\n      if (_this2.isEditMode) {\n        // alert('save first please');\n        changes.month.currentValue = changes.month.previousValue;\n      } else {}\n    })();\n  }\n  ngOnDestroy() {\n    this.displayComponentRef.destroy();\n  }\n  /**\r\n   * Prepare / init the formGroup :\r\n   *   - FormGroup\r\n   *   - Subscribe to the form changes to update assignementsByWeek\r\n   */\n  prepareForm() {\n    // delete this.programsForm; // Why did I wanted to delete ?\n    const group = {};\n    // if (this.mPrograms !== null) {\n    // We do nothing on the initial config\n    this.mPrograms.forEach((program, week) => {\n      group[week] = program.toFormGroup(this.backendService.getSignedInUser()._id);\n    });\n    // }\n    //\n    this.programsForm = new UntypedFormGroup(group);\n  }\n  /**\r\n   * On form change, update the assignments so that we should know\r\n   * of all assignments\r\n   */\n  subscribeToFormChanges() {\n    this.programsForm.valueChanges.subscribe(editedPrograms => {\n      // Add the assignments being made to the list\n      // 1. Build a map of all current edited assignments\n      let tmpArr = [];\n      Object.keys(editedPrograms).forEach(week => {\n        const convAss = this.assignmentService.createAssignment(editedPrograms[week].assignments);\n        tmpArr = tmpArr.concat(convAss.map(a => [a.key, a]));\n      });\n      const currentAss = new Map(tmpArr);\n      // 2. get a copy of the existing assignments\n      const allAssignments = new Map(this.assignmentService.getAssignments());\n      // 3. merge the two maps\n      const mergedAss = new Map([...allAssignments, ...currentAss]);\n      this.assignmentService.groupAssignmentsByUser(mergedAss);\n    });\n  }\n  showLoader(status = true) {\n    this.loading = status;\n    // While loading we disable the picker\n    if (status) {\n      // this.setEditMode(true);\n    }\n  }\n  cancelEdit() {\n    this.setEditMode(false);\n    this.prepareForm();\n    // Reset AssignmentService.assignmentsByUser\n    this.assignmentService.groupAssignmentsByUser();\n  }\n  onSubmit() {\n    const formValue = Object.values(this.programsForm.value);\n    // convert to Program objects\n    const toSave = this.programService.createProgram(formValue);\n    this.showLoader();\n    this.programService.savePrograms(toSave);\n    this.showLoader(false);\n    this.setEditMode(false);\n  }\n  /**\r\n   * Check if the current user is handling the given part\r\n   * @param part\r\n   */\n  isWorkingOnPart(part) {\n    return this.assignmentService.isWorkingOnPart(part);\n  }\n  getDisplayStudentsParts() {\n    return this.assignmentService.displayStudentsParts;\n  }\n  /**\r\n   *\r\n   * Second click on chip deselect it\r\n   * @param displayStudentsParts\r\n   */\n  setDisplayStudentsParts(displayStudentsParts) {\n    if (displayStudentsParts === this.assignmentService.displayStudentsParts) {\n      this.assignmentService.displayStudentsParts = undefined;\n    } else {\n      this.assignmentService.displayStudentsParts = displayStudentsParts;\n    }\n  }\n  static #_ = this.ɵfac = function AssignmentMidweekComponent_Factory(t) {\n    return new (t || AssignmentMidweekComponent)(i0.ɵɵdirectiveInject(i0.ComponentFactoryResolver), i0.ɵɵdirectiveInject(i0.Injector), i0.ɵɵdirectiveInject(i1.AssignmentService), i0.ɵɵdirectiveInject(i2.BackendService), i0.ɵɵdirectiveInject(i3.PartService), i0.ɵɵdirectiveInject(i4.ProgramService), i0.ɵɵdirectiveInject(i5.TranslateService), i0.ɵɵdirectiveInject(i6.UserService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AssignmentMidweekComponent,\n    selectors: [[\"app-assignment-midweek\"]],\n    viewQuery: function AssignmentMidweekComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.printable = _t.first);\n      }\n    },\n    inputs: {\n      month: \"month\"\n    },\n    outputs: {\n      editMode: \"editMode\"\n    },\n    features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature],\n    decls: 4,\n    vars: 6,\n    consts: [[4, \"ngIf\"], [3, \"ngIf\"], [3, \"formGroup\", \"ngSubmit\", 4, \"ngIf\"], [3, \"formGroup\", \"ngSubmit\"], [\"fxLayout\", \"row\", \"fxLayoutAlign\", \"start center\", \"fxLayoutGap\", \"1em\", 4, \"ngIf\"], [\"printableArea\", \"\"], [3, \"formGroupName\", 4, \"ngFor\", \"ngForOf\"], [\"fxLayout\", \"row\", \"fxLayoutAlign\", \"start center\", \"fxLayoutGap\", \"1em\"], [\"type\", \"reset\", \"mat-raised-button\", \"\", \"class\", \"mat-primary\", 3, \"click\", 4, \"ngIf\"], [\"type\", \"submit\", \"mat-raised-button\", \"\", \"class\", \"mat-primary\", 4, \"ngIf\"], [\"type\", \"button\", \"mat-raised-button\", \"\", \"class\", \"mat-primary\", 3, \"click\", 4, \"ngIf\"], [3, \"selected\", \"click\"], [\"type\", \"reset\", \"mat-raised-button\", \"\", 1, \"mat-primary\", 3, \"click\"], [\"fxHide.lt-sm\", \"\"], [\"type\", \"submit\", \"mat-raised-button\", \"\", 1, \"mat-primary\"], [\"type\", \"button\", \"mat-raised-button\", \"\", 1, \"mat-primary\", 3, \"click\"], [3, \"formGroupName\"], [3, \"ngClass\", 4, \"ngIf\"], [3, \"ngClass\"], [\"formArrayName\", \"assignments\", \"fxLayout\", \"column\", \"fxLayoutAlign\", \"start stretch\"], [4, \"ngFor\", \"ngForOf\"], [\"fxFlex\", \"\", \"fxLayout\", \"row wrap\", \"fxLayoutAlign\", \"start center\", \"class\", \"assignment-line\", 3, \"formGroupName\", 4, \"ngIf\"], [\"fxFlex\", \"\", \"fxLayout\", \"row wrap\", \"fxLayoutAlign\", \"start center\", 1, \"assignment-line\", 3, \"formGroupName\"], [\"fxFlex\", \"30\", 1, \"assignment-title\", 3, \"matTooltip\", \"fxFlex.lt-sm\"], [\"fxFlex\", \"70\", \"fxFlex.lt-sm\", \"95\", \"fxFlexOffset.lt-sm\", \"5\", \"fxLayout\", \"row wrap\", \"fxLayoutAlign\", \"space-between center\", 4, \"ngIf\", \"ngIfElse\"], [\"view\", \"\"], [\"fxFlex\", \"70\", \"fxFlex.lt-sm\", \"95\", \"fxFlexOffset.lt-sm\", \"5\", \"fxLayout\", \"row wrap\", \"fxLayoutAlign\", \"space-between center\"], [3, \"fxFlex\"], [\"labelField\", \"fullName\", 3, \"optionsTemplate\", \"title\", \"placeholder\", \"form\", \"controlPath\", \"options\"], [\"fxFlex\", \"49\", 4, \"ngIf\"], [\"fxFlex\", \"49\"], [\"fxFlex\", \"70\", \"fxFlex.lt-xs\", \"95\", \"fxFlexOffset.lt-xs\", \"5\"], [1, \"assignment-assignee\"], [\"class\", \"assignment-assistant\", 4, \"ngIf\"], [1, \"assignment-assistant\"]],\n    template: function AssignmentMidweekComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, AssignmentMidweekComponent_app_loader_0_Template, 1, 0, \"app-loader\", 0);\n        i0.ɵɵtemplate(1, AssignmentMidweekComponent_div_1_Template, 3, 2, \"div\", 0);\n        i0.ɵɵpipe(2, \"async\");\n        i0.ɵɵpipe(3, \"withLoading\");\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.loading);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(2, 2, i0.ɵɵpipeBind1(3, 4, ctx.mPrograms$)));\n      }\n    },\n    dependencies: [i7.NgClass, i7.NgForOf, i7.NgIf, i8.ɵNgNoValidate, i8.NgControlStatusGroup, i9.MatLegacyButton, i10.MatLegacyChipList, i10.MatLegacyChip, i11.MatDivider, i12.MatIcon, i13.MatLegacyTooltip, i8.FormGroupDirective, i8.FormGroupName, i8.FormArrayName, i14.LoaderComponent, i15.PickerComponent, i7.AsyncPipe, i7.TitleCasePipe, i7.KeyValuePipe, i16.TranslateDatePipe, i17.WithLoadingPipe],\n    styles: [\".week-box-edit[_ngcontent-%COMP%] {\\n  padding: 1em;\\n}\\n.week-box-edit[_ngcontent-%COMP%]   .alternate-color[_ngcontent-%COMP%] {\\n  border-top: 1px solid #444444;\\n}\\n\\n.week-box-view[_ngcontent-%COMP%] {\\n  background-color: white;\\n  padding: 1em;\\n  color: #555555;\\n}\\n\\nh2[_ngcontent-%COMP%] {\\n  margin: 0;\\n}\\n\\n.assignments-list[_ngcontent-%COMP%] {\\n  min-height: 20px;\\n  border-radius: 4px;\\n  overflow: hidden;\\n}\\n\\n.assignment-line[_ngcontent-%COMP%] {\\n  margin-bottom: 0.5em;\\n}\\n\\n.assignment-assignee[_ngcontent-%COMP%] {\\n  font-weight: bold;\\n}\\n\\nmat-chip[_ngcontent-%COMP%] {\\n  width: 200px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2lnbm1lbnQtbWlkd2Vlay5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLFlBQUE7QUFDRjtBQUNFO0VBQ0UsNkJBQUE7QUFDSjs7QUFHQTtFQUNFLHVCQUFBO0VBQ0EsWUFBQTtFQUNBLGNBQUE7QUFBRjs7QUFHQTtFQUNFLFNBQUE7QUFBRjs7QUFHQTtFQUVFLGdCQUFBO0VBQ0Esa0JBQUE7RUFDQSxnQkFBQTtBQURGOztBQUlBO0VBQ0Usb0JBQUE7QUFERjs7QUFTRTtFQUNFLGlCQUFBO0FBTko7O0FBYUE7RUFDRSxZQUFBO0FBVkYiLCJmaWxlIjoiYXNzaWdubWVudC1taWR3ZWVrLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLndlZWstYm94LWVkaXQge1xyXG4gIHBhZGRpbmc6IDFlbTtcclxuICAvLyBTdHlsZXMgZm9yIHRoZSBmb3JtXHJcbiAgLmFsdGVybmF0ZS1jb2xvciB7XHJcbiAgICBib3JkZXItdG9wOiAxcHggc29saWQgIzQ0NDQ0NDtcclxuICB9XHJcbn1cclxuXHJcbi53ZWVrLWJveC12aWV3IHtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcclxuICBwYWRkaW5nOiAxZW07XHJcbiAgY29sb3I6ICM1NTU1NTU7XHJcbn1cclxuXHJcbmgyIHtcclxuICBtYXJnaW46IDA7XHJcbn1cclxuXHJcbi5hc3NpZ25tZW50cy1saXN0IHtcclxuICAvLyBib3JkZXI6IGRhc2hlZCAxcHggI2NjYztcclxuICBtaW4taGVpZ2h0OiAyMHB4O1xyXG4gIGJvcmRlci1yYWRpdXM6IDRweDtcclxuICBvdmVyZmxvdzogaGlkZGVuO1xyXG59XHJcblxyXG4uYXNzaWdubWVudC1saW5lIHtcclxuICBtYXJnaW4tYm90dG9tOiAwLjVlbVxyXG59XHJcblxyXG4vLyAuYXNzaWdubWVudC1uYW1lIHt9XHJcblxyXG5cclxuXHJcbi8vIEBtZWRpYSBwcmludCB7XHJcbiAgLmFzc2lnbm1lbnQtYXNzaWduZWUge1xyXG4gICAgZm9udC13ZWlnaHQ6IGJvbGQ7XHJcbiAgfVxyXG5cclxuLy8gfVxyXG5cclxuLy8gLmFzc2lnbm1lbnQtYXNzaXN0YW50IHt9XHJcblxyXG5tYXQtY2hpcCB7XHJcbiAgd2lkdGg6IDIwMHB4O1xyXG59XHJcbiJdfQ== */\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvbW9kdWxlcy9hc3NpZ25tZW50cy9jb21wb25lbnRzL2Fzc2lnbm1lbnQtbWlkd2Vlay9hc3NpZ25tZW50LW1pZHdlZWsuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxZQUFBO0FBQ0Y7QUFDRTtFQUNFLDZCQUFBO0FBQ0o7O0FBR0E7RUFDRSx1QkFBQTtFQUNBLFlBQUE7RUFDQSxjQUFBO0FBQUY7O0FBR0E7RUFDRSxTQUFBO0FBQUY7O0FBR0E7RUFFRSxnQkFBQTtFQUNBLGtCQUFBO0VBQ0EsZ0JBQUE7QUFERjs7QUFJQTtFQUNFLG9CQUFBO0FBREY7O0FBU0U7RUFDRSxpQkFBQTtBQU5KOztBQWFBO0VBQ0UsWUFBQTtBQVZGO0FBQ0EsbzZDQUFvNkMiLCJzb3VyY2VzQ29udGVudCI6WyIud2Vlay1ib3gtZWRpdCB7XHJcbiAgcGFkZGluZzogMWVtO1xyXG4gIC8vIFN0eWxlcyBmb3IgdGhlIGZvcm1cclxuICAuYWx0ZXJuYXRlLWNvbG9yIHtcclxuICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCAjNDQ0NDQ0O1xyXG4gIH1cclxufVxyXG5cclxuLndlZWstYm94LXZpZXcge1xyXG4gIGJhY2tncm91bmQtY29sb3I6IHdoaXRlO1xyXG4gIHBhZGRpbmc6IDFlbTtcclxuICBjb2xvcjogIzU1NTU1NTtcclxufVxyXG5cclxuaDIge1xyXG4gIG1hcmdpbjogMDtcclxufVxyXG5cclxuLmFzc2lnbm1lbnRzLWxpc3Qge1xyXG4gIC8vIGJvcmRlcjogZGFzaGVkIDFweCAjY2NjO1xyXG4gIG1pbi1oZWlnaHQ6IDIwcHg7XHJcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xyXG4gIG92ZXJmbG93OiBoaWRkZW47XHJcbn1cclxuXHJcbi5hc3NpZ25tZW50LWxpbmUge1xyXG4gIG1hcmdpbi1ib3R0b206IDAuNWVtXHJcbn1cclxuXHJcbi8vIC5hc3NpZ25tZW50LW5hbWUge31cclxuXHJcblxyXG5cclxuLy8gQG1lZGlhIHByaW50IHtcclxuICAuYXNzaWdubWVudC1hc3NpZ25lZSB7XHJcbiAgICBmb250LXdlaWdodDogYm9sZDtcclxuICB9XHJcblxyXG4vLyB9XHJcblxyXG4vLyAuYXNzaWdubWVudC1hc3Npc3RhbnQge31cclxuXHJcbm1hdC1jaGlwIHtcclxuICB3aWR0aDogMjAwcHg7XHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n}","map":{"version":3,"names":["EventEmitter","UntypedFormGroup","combineLatest","delay","map","tap","AssignmentCommon","AssignableListComponent","i0","ɵɵelement","ɵɵtext","ɵɵtextInterpolate","ɵɵpipeBind1","ɵɵelementStart","ɵɵlistener","AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_button_1_Template_button_click_0_listener","ɵɵrestoreView","_r15","ctx_r14","ɵɵnextContext","ɵɵresetView","cancelEdit","ɵɵelementEnd","ɵɵadvance","ɵɵtextInterpolate1","AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_button_3_Template_button_click_0_listener","_r17","ctx_r16","setEditMode","AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_button_4_Template_button_click_0_listener","_r19","ctx_r18","saveAsPdf","ɵɵtemplate","AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_button_1_Template","AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_button_2_Template","AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_button_3_Template","AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_button_4_Template","AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_Template_mat_chip_click_6_listener","_r21","ctx_r20","setDisplayStudentsParts","AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_Template_mat_chip_click_8_listener","ctx_r22","ɵɵproperty","ctx_r7","isEditMode","getDisplayStudentsParts","ɵɵpropertyInterpolate2","assignment_r27","title","ɵɵpropertyInterpolate","ctx_r32","displayComponentRef","componentType","programsForm","ɵɵpureFunction2","_c1","program_r25","_id","position","assignableListByPart","AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_div_1_ng_container_6_div_1_div_3_div_6_Template","part","withAssistant","ctx_r29","_c2","name","assistant","fullName","AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_div_1_ng_container_6_div_1_ng_template_4_span_3_Template","assignee","AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_div_1_ng_container_6_div_1_div_3_Template","AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_div_1_ng_container_6_div_1_ng_template_4_Template","ɵɵtemplateRefExtractor","description","ctx_r28","_r30","ɵɵelementContainerStart","AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_div_1_ng_container_6_div_1_Template","ɵɵelementContainerEnd","ctx_r26","isWorkingOnPart","AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_div_1_ng_container_6_Template","_c3","ctx_r24","ɵɵpipeBind3","week","ɵɵpureFunction0","_c4","assignments","AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_div_1_Template","mProgram_r23","key","value","AssignmentMidweekComponent_div_1_ng_template_2_form_0_Template_form_ngSubmit_0_listener","_r42","ctx_r41","onSubmit","AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_1_Template","AssignmentMidweekComponent_div_1_ng_template_2_form_0_div_5_Template","ctx_r5","mPrograms_r6","size","loading","AssignmentMidweekComponent_div_1_ng_template_2_form_0_Template","mProgramsWithLoading_r2","AssignmentMidweekComponent_div_1_ng_template_1_Template","AssignmentMidweekComponent_div_1_ng_template_2_Template","error","AssignmentMidweekComponent","constructor","resolver","injector","assignmentService","backendService","partService","programService","translateService","userService","editMode","meetingName","ngOnInit","_this","data$","data","subscribe","_ref","_asyncToGenerator","users","programs","initializeData","getProgramsByMonth","month","mPrograms$","mPrograms","pipe","v","Map","prepareForm","showLoader","subscribeToFormChanges","_x","apply","arguments","componentFactory","resolveComponentFactory","create","ngOnChanges","changes","_this2","currentValue","previousValue","ngOnDestroy","destroy","group","forEach","program","toFormGroup","getSignedInUser","valueChanges","editedPrograms","tmpArr","Object","keys","convAss","createAssignment","concat","a","currentAss","allAssignments","getAssignments","mergedAss","groupAssignmentsByUser","status","formValue","values","toSave","createProgram","savePrograms","displayStudentsParts","undefined","_","ɵɵdirectiveInject","ComponentFactoryResolver","Injector","i1","AssignmentService","i2","BackendService","i3","PartService","i4","ProgramService","i5","TranslateService","i6","UserService","_2","selectors","viewQuery","AssignmentMidweekComponent_Query","rf","ctx","AssignmentMidweekComponent_app_loader_0_Template","AssignmentMidweekComponent_div_1_Template"],"sources":["C:\\Users\\CSEG\\Desktop\\thassign\\src\\app\\modules\\assignments\\components\\assignment-midweek\\assignment-midweek.component.ts","C:\\Users\\CSEG\\Desktop\\thassign\\src\\app\\modules\\assignments\\components\\assignment-midweek\\assignment-midweek.component.html"],"sourcesContent":["import {\r\n  ApplicationRef,\r\n  Component,\r\n  ComponentFactoryResolver,\r\n  ComponentRef,\r\n  ElementRef,\r\n  EventEmitter,\r\n  Injector,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n  ViewChild,\r\n} from '@angular/core';\r\nimport { FormArray, FormControl, UntypedFormGroup } from '@angular/forms';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { DateTime, Interval } from 'luxon';\r\nimport { combineLatest, concat, Observable, of, Subscription } from 'rxjs';\r\nimport { delay, map, take, tap } from 'rxjs/operators';\r\n\r\nimport { AssignmentCommon } from '@src/app/modules/assignments/components/assignment.common';\r\nimport { AssignableListComponent } from '@src/app/modules/assignments/components/assignable-list/assignable-list.component';\r\nimport { MY_FORMATS } from '@src/app/shared/components/month-picker/month-picker.component';\r\nimport { AssignmentService } from '@src/app/modules/assignments/services/assignment.service';\r\nimport { BackendService } from '@src/app/core/services/backend.service';\r\nimport { PartService } from '@src/app/core/services/part.service';\r\nimport { ProgramService } from '@src/app/core/services/program.service';\r\nimport { UserService } from '@src/app/modules/users/user.service';\r\nimport { Assignment } from '@src/app/core/models/assignment/assignment.model';\r\nimport { Part } from '@src/app/core/models/part/part.model';\r\nimport { Program } from '@src/app/core/models/program.model';\r\nimport { User } from '@src/app/core/models/user/user.model';\r\n\r\n@Component({\r\n  selector: 'app-assignment-midweek',\r\n  templateUrl: './assignment-midweek.component.html',\r\n  styleUrls: ['./assignment-midweek.component.scss'],\r\n})\r\nexport class AssignmentMidweekComponent\r\n  extends AssignmentCommon\r\n  implements OnInit, OnChanges, OnDestroy {\r\n  @Input()\r\n  /**\r\n   * Starting day of the month of this program\r\n   */\r\n  month: DateTime;\r\n\r\n  @Output()\r\n  editMode: EventEmitter<any> = new EventEmitter();\r\n\r\n  @ViewChild('printableArea')\r\n  printable: ElementRef;\r\n\r\n  public displayComponentRef: ComponentRef<AssignableListComponent<User>>;\r\n\r\n  // currentWeek: DateTime;\r\n\r\n  // dateFormat = MY_FORMATS.display.dateA11yLabel;\r\n\r\n  meetingName = 'midweek';\r\n\r\n  /**\r\n   * Map of week to programs\r\n   * week => Program\r\n   */\r\n  mPrograms: Map<string, Program>;\r\n\r\n  /**\r\n   * current month programs\r\n   */\r\n  mPrograms$: Observable<Map<string, Program>>;\r\n\r\n  /**\r\n   * Subscription to observable created by combining\r\n   * Users and Assignments observables\r\n   */\r\n  data$: Subscription;\r\n\r\n  programsForm: UntypedFormGroup;\r\n\r\n  /**\r\n   * Display the Loading msg\r\n   */\r\n  loading = false;\r\n\r\n  constructor(\r\n    private resolver: ComponentFactoryResolver,\r\n    private injector: Injector,\r\n    protected assignmentService: AssignmentService,\r\n    protected backendService: BackendService,\r\n    protected partService: PartService,\r\n    protected programService: ProgramService,\r\n    protected translateService: TranslateService,\r\n    protected userService: UserService\r\n  ) {\r\n    super();\r\n  }\r\n\r\n  ngOnInit() {\r\n    // Pipe to the assignments observable\r\n    this.data$ = combineLatest([\r\n      this.userService.data,\r\n      this.programService.data,\r\n      // this.translateService.onLangChange.asObservable(),\r\n    ]).subscribe(async ([users, programs]) => {\r\n      if (users !== null && programs !== null) {\r\n        // Display form only when observables have started emitting\r\n        await this.initializeData();\r\n\r\n        // Load the assignments of the default month (current)\r\n        // await this.initializeMonthData();\r\n\r\n        await this.programService.getProgramsByMonth('midweek', this.month);\r\n\r\n        this.mPrograms$ = this.programService.mPrograms.pipe(\r\n          map((v) => (v === null ? new Map() : v)), // Map null to empty map\r\n          delay(0), // Useful to prevent an error about loading property\r\n          tap((mPrograms) => {\r\n            this.mPrograms = mPrograms;\r\n\r\n            // Build the form\r\n            this.prepareForm();\r\n\r\n            this.showLoader(false);\r\n            this.subscribeToFormChanges();\r\n          })\r\n        );\r\n      }\r\n    });\r\n\r\n    // Getting the template of the picker\r\n    const componentFactory = this.resolver.resolveComponentFactory(\r\n      AssignableListComponent\r\n    );\r\n    this.displayComponentRef = componentFactory.create(this.injector);\r\n  }\r\n\r\n  async ngOnChanges(changes: SimpleChanges) {\r\n    this.showLoader();\r\n\r\n    // Get the first week as the first monday of the month\r\n    // this.currentWeek = this.month.set({ weekday: 8 });\r\n\r\n    await this.programService.getProgramsByMonth('midweek', this.month);\r\n\r\n    // Check if the previous form was in edit mode : useful ??\r\n    if (this.isEditMode) {\r\n      // alert('save first please');\r\n      changes.month.currentValue = changes.month.previousValue;\r\n    } else {\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.displayComponentRef.destroy();\r\n  }\r\n\r\n  /**\r\n   * Prepare / init the formGroup :\r\n   *   - FormGroup\r\n   *   - Subscribe to the form changes to update assignementsByWeek\r\n   */\r\n  prepareForm() {\r\n    // delete this.programsForm; // Why did I wanted to delete ?\r\n\r\n    const group: any = {};\r\n\r\n    // if (this.mPrograms !== null) {\r\n    // We do nothing on the initial config\r\n    this.mPrograms.forEach((program, week) => {\r\n      group[week] = program.toFormGroup(\r\n        this.backendService.getSignedInUser()._id\r\n      );\r\n    });\r\n    // }\r\n\r\n    //\r\n    this.programsForm = new UntypedFormGroup(group);\r\n  }\r\n\r\n  /**\r\n   * On form change, update the assignments so that we should know\r\n   * of all assignments\r\n   */\r\n  subscribeToFormChanges() {\r\n    this.programsForm.valueChanges.subscribe((editedPrograms) => {\r\n      // Add the assignments being made to the list\r\n      // 1. Build a map of all current edited assignments\r\n      let tmpArr = [];\r\n      Object.keys(editedPrograms).forEach((week) => {\r\n        const convAss = this.assignmentService.createAssignment(\r\n          editedPrograms[week].assignments\r\n        ) as Assignment[];\r\n        tmpArr = tmpArr.concat(convAss.map((a) => [a.key, a]));\r\n      });\r\n      const currentAss = new Map(tmpArr);\r\n\r\n      // 2. get a copy of the existing assignments\r\n      const allAssignments = new Map(this.assignmentService.getAssignments());\r\n\r\n      // 3. merge the two maps\r\n      const mergedAss = new Map([...allAssignments, ...currentAss]) as Map<\r\n        string,\r\n        Assignment\r\n      >;\r\n\r\n      this.assignmentService.groupAssignmentsByUser(mergedAss);\r\n    });\r\n  }\r\n\r\n  showLoader(status = true) {\r\n    this.loading = status;\r\n\r\n    // While loading we disable the picker\r\n    if (status) {\r\n      // this.setEditMode(true);\r\n    }\r\n  }\r\n\r\n  cancelEdit() {\r\n    this.setEditMode(false);\r\n\r\n    this.prepareForm();\r\n\r\n    // Reset AssignmentService.assignmentsByUser\r\n    this.assignmentService.groupAssignmentsByUser();\r\n  }\r\n\r\n  onSubmit() {\r\n    const formValue = Object.values(this.programsForm.value);\r\n\r\n    // convert to Program objects\r\n    const toSave = this.programService.createProgram(formValue) as Program[];\r\n\r\n    this.showLoader();\r\n    this.programService.savePrograms(toSave);\r\n\r\n    this.showLoader(false);\r\n    this.setEditMode(false);\r\n  }\r\n\r\n  /**\r\n   * Check if the current user is handling the given part\r\n   * @param part\r\n   */\r\n  isWorkingOnPart(part: Part): boolean {\r\n    return this.assignmentService.isWorkingOnPart(part);\r\n  }\r\n\r\n  getDisplayStudentsParts(): boolean {\r\n    return this.assignmentService.displayStudentsParts;\r\n  }\r\n\r\n  /**\r\n   *\r\n   * Second click on chip deselect it\r\n   * @param displayStudentsParts\r\n   */\r\n  setDisplayStudentsParts(displayStudentsParts: boolean) {\r\n    if (displayStudentsParts === this.assignmentService.displayStudentsParts) {\r\n      this.assignmentService.displayStudentsParts = undefined;\r\n    } else {\r\n      this.assignmentService.displayStudentsParts = displayStudentsParts;\r\n    }\r\n  }\r\n\r\n  // getMondays() {\r\n  //   let d = new Date();\r\n  //   let month = d.getMonth();\r\n  //   let tuesdays = [];\r\n\r\n  //   d.setDate(1);\r\n\r\n  //   // Get the first Monday in the month\r\n  //   d.setDate(d.getDate() + ((8 - d.getDay()) % 7));\r\n  //   // while (d.getDay() !== 1) {\r\n  //   //     d.setDate(d.getDate() + 1);\r\n  //   // }\r\n\r\n  //   // Get all the other Mondays in the month\r\n  //   while (d.getMonth() === month) {\r\n  //     tuesdays.push(new Date(d.getTime()));\r\n  //     d.setDate(d.getDate() + 7);\r\n  //   }\r\n\r\n  //   return tuesdays;\r\n  // }\r\n}\r\n","<app-loader *ngIf=\"loading\"></app-loader>\r\n\r\n<div *ngIf=\"mPrograms$ | withLoading | async as mProgramsWithLoading\">\r\n  <ng-template [ngIf]=\"mProgramsWithLoading.error\">{{ 'error.general' | translate }}</ng-template>\r\n  <!-- <ng-template [ngIf]=\"mProgramsWithLoading.loading\"><app-loader></app-loader></ng-template> -->\r\n\r\n  <ng-template [ngIf]=\"mProgramsWithLoading.value\">\r\n    <form *ngIf=\"mProgramsWithLoading.value as mPrograms\" \r\n      [formGroup]=\"programsForm\" \r\n      (ngSubmit)=\"onSubmit()\">\r\n      <div *ngIf=\"mPrograms.size && !loading\"\r\n        fxLayout=\"row\"\r\n        fxLayoutAlign=\"start center\"\r\n        fxLayoutGap=\"1em\"> <!-- During loading no buttons-->\r\n        <!-- FORM BUTTONS-->\r\n        <button *ngIf=\"isEditMode\"\r\n          type=\"reset\"\r\n          mat-raised-button\r\n          class=\"mat-primary\"\r\n          (click)=\"cancelEdit()\">\r\n          <mat-icon>undo</mat-icon>\r\n          <span fxHide.lt-sm>\r\n            {{ \"cancel\" | translate | titlecase }}\r\n          </span>\r\n        </button>\r\n\r\n        <button *ngIf=\"isEditMode\"\r\n          type=\"submit\" \r\n          mat-raised-button class=\"mat-primary\">\r\n          <mat-icon>save</mat-icon>\r\n          <span fxHide.lt-sm>\r\n            {{ \"save\" | translate | titlecase }}\r\n          </span>\r\n        </button>\r\n\r\n        <!-- PRINT BUTTONS -->\r\n        <button *ngIf=\"!isEditMode\"\r\n          type=\"button\"\r\n          mat-raised-button\r\n          class=\"mat-primary\"\r\n          (click)=\"setEditMode(true)\">\r\n          <mat-icon>edit</mat-icon>\r\n          <span fxHide.lt-sm>\r\n            {{ \"edit\" | translate | titlecase }}\r\n          </span>\r\n        </button>\r\n\r\n        <button *ngIf=\"!isEditMode\"\r\n          type=\"button\"\r\n          mat-raised-button\r\n          class=\"mat-primary\"\r\n          (click)=\"saveAsPdf()\">\r\n          <mat-icon>print</mat-icon>\r\n          <span fxHide.lt-sm>\r\n            {{ \"print\" | translate | titlecase }}\r\n          </span>\r\n        </button>\r\n\r\n        <!-- PART SELECTOR -->\r\n        <mat-chip-list>\r\n          <mat-chip\r\n            [selected]=\"getDisplayStudentsParts() === true\"\r\n            (click)=\"setDisplayStudentsParts(true);\">\r\n            Students Parts\r\n          </mat-chip>\r\n          <mat-chip\r\n            [selected]=\"getDisplayStudentsParts() === false\"\r\n            (click)=\"setDisplayStudentsParts(false);\">\r\n            Non Students Parts\r\n          </mat-chip>\r\n        </mat-chip-list>\r\n\r\n      </div>\r\n      &nbsp; \r\n      <!-- WEEKS -->\r\n      <div #printableArea>\r\n        <div *ngFor=\"let mProgram of mPrograms | keyvalue\"\r\n          [formGroupName]=\"mProgram.key\">\r\n          <!-- Week block -->\r\n          <div *ngIf=\"mProgram.value as program\" \r\n            [ngClass]=\"{\r\n              'week-box-edit': isEditMode,\r\n              'week-box-view': !isEditMode\r\n            }\">\r\n            <h2>{{ program.week | translateDate: \"MMM-D\" : {days: 6} | async }}</h2>\r\n\r\n            <div formArrayName=\"assignments\" \r\n              fxLayout=\"column\"\r\n              fxLayoutAlign=\"start stretch\">\r\n              <ng-container *ngFor=\"let assignment of program.assignments\">\r\n                <div *ngIf=\"isWorkingOnPart(assignment.part)\"\r\n                  [formGroupName]=\"assignment.position\"\r\n                  fxFlex \r\n                  fxLayout=\"row wrap\"\r\n                  fxLayoutAlign=\"start center\"\r\n                  class=\"assignment-line\">\r\n                  \r\n                  <div class=\"assignment-title\" \r\n                    [matTooltip]=\"assignment.description ? assignment.description: null\"\r\n                    fxFlex=\"30\" \r\n                    [fxFlex.lt-sm]=\"isEditMode ? 100 : null\">\r\n                    {{ assignment.title }}\r\n                  </div>\r\n                  \r\n                  <div *ngIf=\"isEditMode; else view\"\r\n                    fxFlex=\"70\"\r\n                    fxFlex.lt-sm=\"95\"\r\n                    fxFlexOffset.lt-sm=\"5\"\r\n                    fxLayout=\"row wrap\"\r\n                    fxLayoutAlign=\"space-between center\">\r\n                    <div [fxFlex]=\"assignment.part.withAssistant ? 49 : 100\">\r\n                      <app-picker\r\n                        [optionsTemplate]=\"displayComponentRef.componentType\"\r\n                        title=\"{{ assignment.title | titlecase }}\"\r\n                        placeholder=\"{{ 'assignee' | translate | titlecase }}\"\r\n                        [form]=\"programsForm\"\r\n                        [controlPath]=\"[program._id, \r\n                          'assignments', \r\n                          assignment.position, \r\n                          'assignee']\"\r\n                        [options]=\"assignableListByPart[assignment.part.name]\"\r\n                        labelField=\"fullName\"\r\n                      ></app-picker>\r\n                    </div>\r\n\r\n                    <div *ngIf=\"assignment.part.withAssistant\" fxFlex=\"49\">\r\n                      \r\n                      <app-picker\r\n                        [optionsTemplate]=\"displayComponentRef.componentType\"\r\n                        title=\"{{ assignment.title | titlecase }} ({{ 'assistant' | translate | titlecase }})\"\r\n                        placeholder=\"{{ 'assistant' | translate | titlecase }}\"\r\n                        [form]=\"programsForm\"\r\n                        [controlPath]=\"[program._id, \r\n                          'assignments', \r\n                          assignment.position, \r\n                          'assistant']\"\r\n                        [options]=\"assignableListByPart['clm.ministry.assistant']\"\r\n                        labelField=\"fullName\"\r\n                      ></app-picker>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <ng-template #view>\r\n                    <div fxFlex=\"70\" \r\n                      fxFlex.lt-xs=\"95\" \r\n                      fxFlexOffset.lt-xs=\"5\">\r\n                      <span class=\"assignment-assignee\">{{ assignment.assignee?.fullName }}</span>\r\n\r\n                      <span *ngIf=\"assignment.assistant\" class=\"assignment-assistant\">\r\n                        &nbsp;/&nbsp;{{ assignment.assistant?.fullName }}</span>\r\n                    </div>\r\n                  </ng-template>\r\n                  <mat-divider></mat-divider>\r\n                </div>\r\n              </ng-container>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  </ng-template>\r\n</div>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}